<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<meta name="generator" content="Asciidoctor 2.0.20">
<meta name="author" content="Jeroen Hellingman">
<title>Tei2html</title>
<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:300,300italic,400,400italic,600,600italic%7CNoto+Serif:400,400italic,700,700italic%7CDroid+Sans+Mono:400,700">
<style>
/*! Asciidoctor default stylesheet | MIT License | https://asciidoctor.org */
/* Uncomment the following line when using as a custom stylesheet */
/* @import "https://fonts.googleapis.com/css?family=Open+Sans:300,300italic,400,400italic,600,600italic%7CNoto+Serif:400,400italic,700,700italic%7CDroid+Sans+Mono:400,700"; */
html{font-family:sans-serif;-webkit-text-size-adjust:100%}
a{background:none}
a:focus{outline:thin dotted}
a:active,a:hover{outline:0}
h1{font-size:2em;margin:.67em 0}
b,strong{font-weight:bold}
abbr{font-size:.9em}
abbr[title]{cursor:help;border-bottom:1px dotted #dddddf;text-decoration:none}
dfn{font-style:italic}
hr{height:0}
mark{background:#ff0;color:#000}
code,kbd,pre,samp{font-family:monospace;font-size:1em}
pre{white-space:pre-wrap}
q{quotes:"\201C" "\201D" "\2018" "\2019"}
small{font-size:80%}
sub,sup{font-size:75%;line-height:0;position:relative;vertical-align:baseline}
sup{top:-.5em}
sub{bottom:-.25em}
img{border:0}
svg:not(:root){overflow:hidden}
figure{margin:0}
audio,video{display:inline-block}
audio:not([controls]){display:none;height:0}
fieldset{border:1px solid silver;margin:0 2px;padding:.35em .625em .75em}
legend{border:0;padding:0}
button,input,select,textarea{font-family:inherit;font-size:100%;margin:0}
button,input{line-height:normal}
button,select{text-transform:none}
button,html input[type=button],input[type=reset],input[type=submit]{-webkit-appearance:button;cursor:pointer}
button[disabled],html input[disabled]{cursor:default}
input[type=checkbox],input[type=radio]{padding:0}
button::-moz-focus-inner,input::-moz-focus-inner{border:0;padding:0}
textarea{overflow:auto;vertical-align:top}
table{border-collapse:collapse;border-spacing:0}
*,::before,::after{box-sizing:border-box}
html,body{font-size:100%}
body{background:#fff;color:rgba(0,0,0,.8);padding:0;margin:0;font-family:"Noto Serif","DejaVu Serif",serif;line-height:1;position:relative;cursor:auto;-moz-tab-size:4;-o-tab-size:4;tab-size:4;word-wrap:anywhere;-moz-osx-font-smoothing:grayscale;-webkit-font-smoothing:antialiased}
a:hover{cursor:pointer}
img,object,embed{max-width:100%;height:auto}
object,embed{height:100%}
img{-ms-interpolation-mode:bicubic}
.left{float:left!important}
.right{float:right!important}
.text-left{text-align:left!important}
.text-right{text-align:right!important}
.text-center{text-align:center!important}
.text-justify{text-align:justify!important}
.hide{display:none}
img,object,svg{display:inline-block;vertical-align:middle}
textarea{height:auto;min-height:50px}
select{width:100%}
.subheader,.admonitionblock td.content>.title,.audioblock>.title,.exampleblock>.title,.imageblock>.title,.listingblock>.title,.literalblock>.title,.stemblock>.title,.openblock>.title,.paragraph>.title,.quoteblock>.title,table.tableblock>.title,.verseblock>.title,.videoblock>.title,.dlist>.title,.olist>.title,.ulist>.title,.qlist>.title,.hdlist>.title{line-height:1.45;color:#7a2518;font-weight:400;margin-top:0;margin-bottom:.25em}
div,dl,dt,dd,ul,ol,li,h1,h2,h3,#toctitle,.sidebarblock>.content>.title,h4,h5,h6,pre,form,p,blockquote,th,td{margin:0;padding:0}
a{color:#2156a5;text-decoration:underline;line-height:inherit}
a:hover,a:focus{color:#1d4b8f}
a img{border:0}
p{line-height:1.6;margin-bottom:1.25em;text-rendering:optimizeLegibility}
p aside{font-size:.875em;line-height:1.35;font-style:italic}
h1,h2,h3,#toctitle,.sidebarblock>.content>.title,h4,h5,h6{font-family:"Open Sans","DejaVu Sans",sans-serif;font-weight:300;font-style:normal;color:#ba3925;text-rendering:optimizeLegibility;margin-top:1em;margin-bottom:.5em;line-height:1.0125em}
h1 small,h2 small,h3 small,#toctitle small,.sidebarblock>.content>.title small,h4 small,h5 small,h6 small{font-size:60%;color:#e99b8f;line-height:0}
h1{font-size:2.125em}
h2{font-size:1.6875em}
h3,#toctitle,.sidebarblock>.content>.title{font-size:1.375em}
h4,h5{font-size:1.125em}
h6{font-size:1em}
hr{border:solid #dddddf;border-width:1px 0 0;clear:both;margin:1.25em 0 1.1875em}
em,i{font-style:italic;line-height:inherit}
strong,b{font-weight:bold;line-height:inherit}
small{font-size:60%;line-height:inherit}
code{font-family:"Droid Sans Mono","DejaVu Sans Mono",monospace;font-weight:400;color:rgba(0,0,0,.9)}
ul,ol,dl{line-height:1.6;margin-bottom:1.25em;list-style-position:outside;font-family:inherit}
ul,ol{margin-left:1.5em}
ul li ul,ul li ol{margin-left:1.25em;margin-bottom:0}
ul.circle{list-style-type:circle}
ul.disc{list-style-type:disc}
ul.square{list-style-type:square}
ul.circle ul:not([class]),ul.disc ul:not([class]),ul.square ul:not([class]){list-style:inherit}
ol li ul,ol li ol{margin-left:1.25em;margin-bottom:0}
dl dt{margin-bottom:.3125em;font-weight:bold}
dl dd{margin-bottom:1.25em}
blockquote{margin:0 0 1.25em;padding:.5625em 1.25em 0 1.1875em;border-left:1px solid #ddd}
blockquote,blockquote p{line-height:1.6;color:rgba(0,0,0,.85)}
@media screen and (min-width:768px){h1,h2,h3,#toctitle,.sidebarblock>.content>.title,h4,h5,h6{line-height:1.2}
h1{font-size:2.75em}
h2{font-size:2.3125em}
h3,#toctitle,.sidebarblock>.content>.title{font-size:1.6875em}
h4{font-size:1.4375em}}
table{background:#fff;margin-bottom:1.25em;border:1px solid #dedede;word-wrap:normal}
table thead,table tfoot{background:#f7f8f7}
table thead tr th,table thead tr td,table tfoot tr th,table tfoot tr td{padding:.5em .625em .625em;font-size:inherit;color:rgba(0,0,0,.8);text-align:left}
table tr th,table tr td{padding:.5625em .625em;font-size:inherit;color:rgba(0,0,0,.8)}
table tr.even,table tr.alt{background:#f8f8f7}
table thead tr th,table tfoot tr th,table tbody tr td,table tr td,table tfoot tr td{line-height:1.6}
h1,h2,h3,#toctitle,.sidebarblock>.content>.title,h4,h5,h6{line-height:1.2;word-spacing:-.05em}
h1 strong,h2 strong,h3 strong,#toctitle strong,.sidebarblock>.content>.title strong,h4 strong,h5 strong,h6 strong{font-weight:400}
.center{margin-left:auto;margin-right:auto}
.stretch{width:100%}
.clearfix::before,.clearfix::after,.float-group::before,.float-group::after{content:" ";display:table}
.clearfix::after,.float-group::after{clear:both}
:not(pre).nobreak{word-wrap:normal}
:not(pre).nowrap{white-space:nowrap}
:not(pre).pre-wrap{white-space:pre-wrap}
:not(pre):not([class^=L])>code{font-size:.9375em;font-style:normal!important;letter-spacing:0;padding:.1em .5ex;word-spacing:-.15em;background:#f7f7f8;border-radius:4px;line-height:1.45;text-rendering:optimizeSpeed}
pre{color:rgba(0,0,0,.9);font-family:"Droid Sans Mono","DejaVu Sans Mono",monospace;line-height:1.45;text-rendering:optimizeSpeed}
pre code,pre pre{color:inherit;font-size:inherit;line-height:inherit}
pre>code{display:block}
pre.nowrap,pre.nowrap pre{white-space:pre;word-wrap:normal}
em em{font-style:normal}
strong strong{font-weight:400}
.keyseq{color:rgba(51,51,51,.8)}
kbd{font-family:"Droid Sans Mono","DejaVu Sans Mono",monospace;display:inline-block;color:rgba(0,0,0,.8);font-size:.65em;line-height:1.45;background:#f7f7f7;border:1px solid #ccc;border-radius:3px;box-shadow:0 1px 0 rgba(0,0,0,.2),inset 0 0 0 .1em #fff;margin:0 .15em;padding:.2em .5em;vertical-align:middle;position:relative;top:-.1em;white-space:nowrap}
.keyseq kbd:first-child{margin-left:0}
.keyseq kbd:last-child{margin-right:0}
.menuseq,.menuref{color:#000}
.menuseq b:not(.caret),.menuref{font-weight:inherit}
.menuseq{word-spacing:-.02em}
.menuseq b.caret{font-size:1.25em;line-height:.8}
.menuseq i.caret{font-weight:bold;text-align:center;width:.45em}
b.button::before,b.button::after{position:relative;top:-1px;font-weight:400}
b.button::before{content:"[";padding:0 3px 0 2px}
b.button::after{content:"]";padding:0 2px 0 3px}
p a>code:hover{color:rgba(0,0,0,.9)}
#header,#content,#footnotes,#footer{width:100%;margin:0 auto;max-width:62.5em;*zoom:1;position:relative;padding-left:.9375em;padding-right:.9375em}
#header::before,#header::after,#content::before,#content::after,#footnotes::before,#footnotes::after,#footer::before,#footer::after{content:" ";display:table}
#header::after,#content::after,#footnotes::after,#footer::after{clear:both}
#content{margin-top:1.25em}
#content::before{content:none}
#header>h1:first-child{color:rgba(0,0,0,.85);margin-top:2.25rem;margin-bottom:0}
#header>h1:first-child+#toc{margin-top:8px;border-top:1px solid #dddddf}
#header>h1:only-child,body.toc2 #header>h1:nth-last-child(2){border-bottom:1px solid #dddddf;padding-bottom:8px}
#header .details{border-bottom:1px solid #dddddf;line-height:1.45;padding-top:.25em;padding-bottom:.25em;padding-left:.25em;color:rgba(0,0,0,.6);display:flex;flex-flow:row wrap}
#header .details span:first-child{margin-left:-.125em}
#header .details span.email a{color:rgba(0,0,0,.85)}
#header .details br{display:none}
#header .details br+span::before{content:"\00a0\2013\00a0"}
#header .details br+span.author::before{content:"\00a0\22c5\00a0";color:rgba(0,0,0,.85)}
#header .details br+span#revremark::before{content:"\00a0|\00a0"}
#header #revnumber{text-transform:capitalize}
#header #revnumber::after{content:"\00a0"}
#content>h1:first-child:not([class]){color:rgba(0,0,0,.85);border-bottom:1px solid #dddddf;padding-bottom:8px;margin-top:0;padding-top:1rem;margin-bottom:1.25rem}
#toc{border-bottom:1px solid #e7e7e9;padding-bottom:.5em}
#toc>ul{margin-left:.125em}
#toc ul.sectlevel0>li>a{font-style:italic}
#toc ul.sectlevel0 ul.sectlevel1{margin:.5em 0}
#toc ul{font-family:"Open Sans","DejaVu Sans",sans-serif;list-style-type:none}
#toc li{line-height:1.3334;margin-top:.3334em}
#toc a{text-decoration:none}
#toc a:active{text-decoration:underline}
#toctitle{color:#7a2518;font-size:1.2em}
@media screen and (min-width:768px){#toctitle{font-size:1.375em}
body.toc2{padding-left:15em;padding-right:0}
#toc.toc2{margin-top:0!important;background:#f8f8f7;position:fixed;width:15em;left:0;top:0;border-right:1px solid #e7e7e9;border-top-width:0!important;border-bottom-width:0!important;z-index:1000;padding:1.25em 1em;height:100%;overflow:auto}
#toc.toc2 #toctitle{margin-top:0;margin-bottom:.8rem;font-size:1.2em}
#toc.toc2>ul{font-size:.9em;margin-bottom:0}
#toc.toc2 ul ul{margin-left:0;padding-left:1em}
#toc.toc2 ul.sectlevel0 ul.sectlevel1{padding-left:0;margin-top:.5em;margin-bottom:.5em}
body.toc2.toc-right{padding-left:0;padding-right:15em}
body.toc2.toc-right #toc.toc2{border-right-width:0;border-left:1px solid #e7e7e9;left:auto;right:0}}
@media screen and (min-width:1280px){body.toc2{padding-left:20em;padding-right:0}
#toc.toc2{width:20em}
#toc.toc2 #toctitle{font-size:1.375em}
#toc.toc2>ul{font-size:.95em}
#toc.toc2 ul ul{padding-left:1.25em}
body.toc2.toc-right{padding-left:0;padding-right:20em}}
#content #toc{border:1px solid #e0e0dc;margin-bottom:1.25em;padding:1.25em;background:#f8f8f7;border-radius:4px}
#content #toc>:first-child{margin-top:0}
#content #toc>:last-child{margin-bottom:0}
#footer{max-width:none;background:rgba(0,0,0,.8);padding:1.25em}
#footer-text{color:hsla(0,0%,100%,.8);line-height:1.44}
#content{margin-bottom:.625em}
.sect1{padding-bottom:.625em}
@media screen and (min-width:768px){#content{margin-bottom:1.25em}
.sect1{padding-bottom:1.25em}}
.sect1:last-child{padding-bottom:0}
.sect1+.sect1{border-top:1px solid #e7e7e9}
#content h1>a.anchor,h2>a.anchor,h3>a.anchor,#toctitle>a.anchor,.sidebarblock>.content>.title>a.anchor,h4>a.anchor,h5>a.anchor,h6>a.anchor{position:absolute;z-index:1001;width:1.5ex;margin-left:-1.5ex;display:block;text-decoration:none!important;visibility:hidden;text-align:center;font-weight:400}
#content h1>a.anchor::before,h2>a.anchor::before,h3>a.anchor::before,#toctitle>a.anchor::before,.sidebarblock>.content>.title>a.anchor::before,h4>a.anchor::before,h5>a.anchor::before,h6>a.anchor::before{content:"\00A7";font-size:.85em;display:block;padding-top:.1em}
#content h1:hover>a.anchor,#content h1>a.anchor:hover,h2:hover>a.anchor,h2>a.anchor:hover,h3:hover>a.anchor,#toctitle:hover>a.anchor,.sidebarblock>.content>.title:hover>a.anchor,h3>a.anchor:hover,#toctitle>a.anchor:hover,.sidebarblock>.content>.title>a.anchor:hover,h4:hover>a.anchor,h4>a.anchor:hover,h5:hover>a.anchor,h5>a.anchor:hover,h6:hover>a.anchor,h6>a.anchor:hover{visibility:visible}
#content h1>a.link,h2>a.link,h3>a.link,#toctitle>a.link,.sidebarblock>.content>.title>a.link,h4>a.link,h5>a.link,h6>a.link{color:#ba3925;text-decoration:none}
#content h1>a.link:hover,h2>a.link:hover,h3>a.link:hover,#toctitle>a.link:hover,.sidebarblock>.content>.title>a.link:hover,h4>a.link:hover,h5>a.link:hover,h6>a.link:hover{color:#a53221}
details,.audioblock,.imageblock,.literalblock,.listingblock,.stemblock,.videoblock{margin-bottom:1.25em}
details{margin-left:1.25rem}
details>summary{cursor:pointer;display:block;position:relative;line-height:1.6;margin-bottom:.625rem;outline:none;-webkit-tap-highlight-color:transparent}
details>summary::-webkit-details-marker{display:none}
details>summary::before{content:"";border:solid transparent;border-left:solid;border-width:.3em 0 .3em .5em;position:absolute;top:.5em;left:-1.25rem;transform:translateX(15%)}
details[open]>summary::before{border:solid transparent;border-top:solid;border-width:.5em .3em 0;transform:translateY(15%)}
details>summary::after{content:"";width:1.25rem;height:1em;position:absolute;top:.3em;left:-1.25rem}
.admonitionblock td.content>.title,.audioblock>.title,.exampleblock>.title,.imageblock>.title,.listingblock>.title,.literalblock>.title,.stemblock>.title,.openblock>.title,.paragraph>.title,.quoteblock>.title,table.tableblock>.title,.verseblock>.title,.videoblock>.title,.dlist>.title,.olist>.title,.ulist>.title,.qlist>.title,.hdlist>.title{text-rendering:optimizeLegibility;text-align:left;font-family:"Noto Serif","DejaVu Serif",serif;font-size:1rem;font-style:italic}
table.tableblock.fit-content>caption.title{white-space:nowrap;width:0}
.paragraph.lead>p,#preamble>.sectionbody>[class=paragraph]:first-of-type p{font-size:1.21875em;line-height:1.6;color:rgba(0,0,0,.85)}
.admonitionblock>table{border-collapse:separate;border:0;background:none;width:100%}
.admonitionblock>table td.icon{text-align:center;width:80px}
.admonitionblock>table td.icon img{max-width:none}
.admonitionblock>table td.icon .title{font-weight:bold;font-family:"Open Sans","DejaVu Sans",sans-serif;text-transform:uppercase}
.admonitionblock>table td.content{padding-left:1.125em;padding-right:1.25em;border-left:1px solid #dddddf;color:rgba(0,0,0,.6);word-wrap:anywhere}
.admonitionblock>table td.content>:last-child>:last-child{margin-bottom:0}
.exampleblock>.content{border:1px solid #e6e6e6;margin-bottom:1.25em;padding:1.25em;background:#fff;border-radius:4px}
.sidebarblock{border:1px solid #dbdbd6;margin-bottom:1.25em;padding:1.25em;background:#f3f3f2;border-radius:4px}
.sidebarblock>.content>.title{color:#7a2518;margin-top:0;text-align:center}
.exampleblock>.content>:first-child,.sidebarblock>.content>:first-child{margin-top:0}
.exampleblock>.content>:last-child,.exampleblock>.content>:last-child>:last-child,.exampleblock>.content .olist>ol>li:last-child>:last-child,.exampleblock>.content .ulist>ul>li:last-child>:last-child,.exampleblock>.content .qlist>ol>li:last-child>:last-child,.sidebarblock>.content>:last-child,.sidebarblock>.content>:last-child>:last-child,.sidebarblock>.content .olist>ol>li:last-child>:last-child,.sidebarblock>.content .ulist>ul>li:last-child>:last-child,.sidebarblock>.content .qlist>ol>li:last-child>:last-child{margin-bottom:0}
.literalblock pre,.listingblock>.content>pre{border-radius:4px;overflow-x:auto;padding:1em;font-size:.8125em}
@media screen and (min-width:768px){.literalblock pre,.listingblock>.content>pre{font-size:.90625em}}
@media screen and (min-width:1280px){.literalblock pre,.listingblock>.content>pre{font-size:1em}}
.literalblock pre,.listingblock>.content>pre:not(.highlight),.listingblock>.content>pre[class=highlight],.listingblock>.content>pre[class^="highlight "]{background:#f7f7f8}
.literalblock.output pre{color:#f7f7f8;background:rgba(0,0,0,.9)}
.listingblock>.content{position:relative}
.listingblock code[data-lang]::before{display:none;content:attr(data-lang);position:absolute;font-size:.75em;top:.425rem;right:.5rem;line-height:1;text-transform:uppercase;color:inherit;opacity:.5}
.listingblock:hover code[data-lang]::before{display:block}
.listingblock.terminal pre .command::before{content:attr(data-prompt);padding-right:.5em;color:inherit;opacity:.5}
.listingblock.terminal pre .command:not([data-prompt])::before{content:"$"}
.listingblock pre.highlightjs{padding:0}
.listingblock pre.highlightjs>code{padding:1em;border-radius:4px}
.listingblock pre.prettyprint{border-width:0}
.prettyprint{background:#f7f7f8}
pre.prettyprint .linenums{line-height:1.45;margin-left:2em}
pre.prettyprint li{background:none;list-style-type:inherit;padding-left:0}
pre.prettyprint li code[data-lang]::before{opacity:1}
pre.prettyprint li:not(:first-child) code[data-lang]::before{display:none}
table.linenotable{border-collapse:separate;border:0;margin-bottom:0;background:none}
table.linenotable td[class]{color:inherit;vertical-align:top;padding:0;line-height:inherit;white-space:normal}
table.linenotable td.code{padding-left:.75em}
table.linenotable td.linenos,pre.pygments .linenos{border-right:1px solid;opacity:.35;padding-right:.5em;-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none}
pre.pygments span.linenos{display:inline-block;margin-right:.75em}
.quoteblock{margin:0 1em 1.25em 1.5em;display:table}
.quoteblock:not(.excerpt)>.title{margin-left:-1.5em;margin-bottom:.75em}
.quoteblock blockquote,.quoteblock p{color:rgba(0,0,0,.85);font-size:1.15rem;line-height:1.75;word-spacing:.1em;letter-spacing:0;font-style:italic;text-align:justify}
.quoteblock blockquote{margin:0;padding:0;border:0}
.quoteblock blockquote::before{content:"\201c";float:left;font-size:2.75em;font-weight:bold;line-height:.6em;margin-left:-.6em;color:#7a2518;text-shadow:0 1px 2px rgba(0,0,0,.1)}
.quoteblock blockquote>.paragraph:last-child p{margin-bottom:0}
.quoteblock .attribution{margin-top:.75em;margin-right:.5ex;text-align:right}
.verseblock{margin:0 1em 1.25em}
.verseblock pre{font-family:"Open Sans","DejaVu Sans",sans-serif;font-size:1.15rem;color:rgba(0,0,0,.85);font-weight:300;text-rendering:optimizeLegibility}
.verseblock pre strong{font-weight:400}
.verseblock .attribution{margin-top:1.25rem;margin-left:.5ex}
.quoteblock .attribution,.verseblock .attribution{font-size:.9375em;line-height:1.45;font-style:italic}
.quoteblock .attribution br,.verseblock .attribution br{display:none}
.quoteblock .attribution cite,.verseblock .attribution cite{display:block;letter-spacing:-.025em;color:rgba(0,0,0,.6)}
.quoteblock.abstract blockquote::before,.quoteblock.excerpt blockquote::before,.quoteblock .quoteblock blockquote::before{display:none}
.quoteblock.abstract blockquote,.quoteblock.abstract p,.quoteblock.excerpt blockquote,.quoteblock.excerpt p,.quoteblock .quoteblock blockquote,.quoteblock .quoteblock p{line-height:1.6;word-spacing:0}
.quoteblock.abstract{margin:0 1em 1.25em;display:block}
.quoteblock.abstract>.title{margin:0 0 .375em;font-size:1.15em;text-align:center}
.quoteblock.excerpt>blockquote,.quoteblock .quoteblock{padding:0 0 .25em 1em;border-left:.25em solid #dddddf}
.quoteblock.excerpt,.quoteblock .quoteblock{margin-left:0}
.quoteblock.excerpt blockquote,.quoteblock.excerpt p,.quoteblock .quoteblock blockquote,.quoteblock .quoteblock p{color:inherit;font-size:1.0625rem}
.quoteblock.excerpt .attribution,.quoteblock .quoteblock .attribution{color:inherit;font-size:.85rem;text-align:left;margin-right:0}
p.tableblock:last-child{margin-bottom:0}
td.tableblock>.content{margin-bottom:1.25em;word-wrap:anywhere}
td.tableblock>.content>:last-child{margin-bottom:-1.25em}
table.tableblock,th.tableblock,td.tableblock{border:0 solid #dedede}
table.grid-all>*>tr>*{border-width:1px}
table.grid-cols>*>tr>*{border-width:0 1px}
table.grid-rows>*>tr>*{border-width:1px 0}
table.frame-all{border-width:1px}
table.frame-ends{border-width:1px 0}
table.frame-sides{border-width:0 1px}
table.frame-none>colgroup+*>:first-child>*,table.frame-sides>colgroup+*>:first-child>*{border-top-width:0}
table.frame-none>:last-child>:last-child>*,table.frame-sides>:last-child>:last-child>*{border-bottom-width:0}
table.frame-none>*>tr>:first-child,table.frame-ends>*>tr>:first-child{border-left-width:0}
table.frame-none>*>tr>:last-child,table.frame-ends>*>tr>:last-child{border-right-width:0}
table.stripes-all>*>tr,table.stripes-odd>*>tr:nth-of-type(odd),table.stripes-even>*>tr:nth-of-type(even),table.stripes-hover>*>tr:hover{background:#f8f8f7}
th.halign-left,td.halign-left{text-align:left}
th.halign-right,td.halign-right{text-align:right}
th.halign-center,td.halign-center{text-align:center}
th.valign-top,td.valign-top{vertical-align:top}
th.valign-bottom,td.valign-bottom{vertical-align:bottom}
th.valign-middle,td.valign-middle{vertical-align:middle}
table thead th,table tfoot th{font-weight:bold}
tbody tr th{background:#f7f8f7}
tbody tr th,tbody tr th p,tfoot tr th,tfoot tr th p{color:rgba(0,0,0,.8);font-weight:bold}
p.tableblock>code:only-child{background:none;padding:0}
p.tableblock{font-size:1em}
ol{margin-left:1.75em}
ul li ol{margin-left:1.5em}
dl dd{margin-left:1.125em}
dl dd:last-child,dl dd:last-child>:last-child{margin-bottom:0}
li p,ul dd,ol dd,.olist .olist,.ulist .ulist,.ulist .olist,.olist .ulist{margin-bottom:.625em}
ul.checklist,ul.none,ol.none,ul.no-bullet,ol.no-bullet,ol.unnumbered,ul.unstyled,ol.unstyled{list-style-type:none}
ul.no-bullet,ol.no-bullet,ol.unnumbered{margin-left:.625em}
ul.unstyled,ol.unstyled{margin-left:0}
li>p:empty:only-child::before{content:"";display:inline-block}
ul.checklist>li>p:first-child{margin-left:-1em}
ul.checklist>li>p:first-child>.fa-square-o:first-child,ul.checklist>li>p:first-child>.fa-check-square-o:first-child{width:1.25em;font-size:.8em;position:relative;bottom:.125em}
ul.checklist>li>p:first-child>input[type=checkbox]:first-child{margin-right:.25em}
ul.inline{display:flex;flex-flow:row wrap;list-style:none;margin:0 0 .625em -1.25em}
ul.inline>li{margin-left:1.25em}
.unstyled dl dt{font-weight:400;font-style:normal}
ol.arabic{list-style-type:decimal}
ol.decimal{list-style-type:decimal-leading-zero}
ol.loweralpha{list-style-type:lower-alpha}
ol.upperalpha{list-style-type:upper-alpha}
ol.lowerroman{list-style-type:lower-roman}
ol.upperroman{list-style-type:upper-roman}
ol.lowergreek{list-style-type:lower-greek}
.hdlist>table,.colist>table{border:0;background:none}
.hdlist>table>tbody>tr,.colist>table>tbody>tr{background:none}
td.hdlist1,td.hdlist2{vertical-align:top;padding:0 .625em}
td.hdlist1{font-weight:bold;padding-bottom:1.25em}
td.hdlist2{word-wrap:anywhere}
.literalblock+.colist,.listingblock+.colist{margin-top:-.5em}
.colist td:not([class]):first-child{padding:.4em .75em 0;line-height:1;vertical-align:top}
.colist td:not([class]):first-child img{max-width:none}
.colist td:not([class]):last-child{padding:.25em 0}
.thumb,.th{line-height:0;display:inline-block;border:4px solid #fff;box-shadow:0 0 0 1px #ddd}
.imageblock.left{margin:.25em .625em 1.25em 0}
.imageblock.right{margin:.25em 0 1.25em .625em}
.imageblock>.title{margin-bottom:0}
.imageblock.thumb,.imageblock.th{border-width:6px}
.imageblock.thumb>.title,.imageblock.th>.title{padding:0 .125em}
.image.left,.image.right{margin-top:.25em;margin-bottom:.25em;display:inline-block;line-height:0}
.image.left{margin-right:.625em}
.image.right{margin-left:.625em}
a.image{text-decoration:none;display:inline-block}
a.image object{pointer-events:none}
sup.footnote,sup.footnoteref{font-size:.875em;position:static;vertical-align:super}
sup.footnote a,sup.footnoteref a{text-decoration:none}
sup.footnote a:active,sup.footnoteref a:active{text-decoration:underline}
#footnotes{padding-top:.75em;padding-bottom:.75em;margin-bottom:.625em}
#footnotes hr{width:20%;min-width:6.25em;margin:-.25em 0 .75em;border-width:1px 0 0}
#footnotes .footnote{padding:0 .375em 0 .225em;line-height:1.3334;font-size:.875em;margin-left:1.2em;margin-bottom:.2em}
#footnotes .footnote a:first-of-type{font-weight:bold;text-decoration:none;margin-left:-1.05em}
#footnotes .footnote:last-of-type{margin-bottom:0}
#content #footnotes{margin-top:-.625em;margin-bottom:0;padding:.75em 0}
div.unbreakable{page-break-inside:avoid}
.big{font-size:larger}
.small{font-size:smaller}
.underline{text-decoration:underline}
.overline{text-decoration:overline}
.line-through{text-decoration:line-through}
.aqua{color:#00bfbf}
.aqua-background{background:#00fafa}
.black{color:#000}
.black-background{background:#000}
.blue{color:#0000bf}
.blue-background{background:#0000fa}
.fuchsia{color:#bf00bf}
.fuchsia-background{background:#fa00fa}
.gray{color:#606060}
.gray-background{background:#7d7d7d}
.green{color:#006000}
.green-background{background:#007d00}
.lime{color:#00bf00}
.lime-background{background:#00fa00}
.maroon{color:#600000}
.maroon-background{background:#7d0000}
.navy{color:#000060}
.navy-background{background:#00007d}
.olive{color:#606000}
.olive-background{background:#7d7d00}
.purple{color:#600060}
.purple-background{background:#7d007d}
.red{color:#bf0000}
.red-background{background:#fa0000}
.silver{color:#909090}
.silver-background{background:#bcbcbc}
.teal{color:#006060}
.teal-background{background:#007d7d}
.white{color:#bfbfbf}
.white-background{background:#fafafa}
.yellow{color:#bfbf00}
.yellow-background{background:#fafa00}
span.icon>.fa{cursor:default}
a span.icon>.fa{cursor:inherit}
.admonitionblock td.icon [class^="fa icon-"]{font-size:2.5em;text-shadow:1px 1px 2px rgba(0,0,0,.5);cursor:default}
.admonitionblock td.icon .icon-note::before{content:"\f05a";color:#19407c}
.admonitionblock td.icon .icon-tip::before{content:"\f0eb";text-shadow:1px 1px 2px rgba(155,155,0,.8);color:#111}
.admonitionblock td.icon .icon-warning::before{content:"\f071";color:#bf6900}
.admonitionblock td.icon .icon-caution::before{content:"\f06d";color:#bf3400}
.admonitionblock td.icon .icon-important::before{content:"\f06a";color:#bf0000}
.conum[data-value]{display:inline-block;color:#fff!important;background:rgba(0,0,0,.8);border-radius:50%;text-align:center;font-size:.75em;width:1.67em;height:1.67em;line-height:1.67em;font-family:"Open Sans","DejaVu Sans",sans-serif;font-style:normal;font-weight:bold}
.conum[data-value] *{color:#fff!important}
.conum[data-value]+b{display:none}
.conum[data-value]::after{content:attr(data-value)}
pre .conum[data-value]{position:relative;top:-.125em}
b.conum *{color:inherit!important}
.conum:not([data-value]):empty{display:none}
dt,th.tableblock,td.content,div.footnote{text-rendering:optimizeLegibility}
h1,h2,p,td.content,span.alt,summary{letter-spacing:-.01em}
p strong,td.content strong,div.footnote strong{letter-spacing:-.005em}
p,blockquote,dt,td.content,td.hdlist1,span.alt,summary{font-size:1.0625rem}
p{margin-bottom:1.25rem}
.sidebarblock p,.sidebarblock dt,.sidebarblock td.content,p.tableblock{font-size:1em}
.exampleblock>.content{background:#fffef7;border-color:#e0e0dc;box-shadow:0 1px 4px #e0e0dc}
.print-only{display:none!important}
@page{margin:1.25cm .75cm}
@media print{*{box-shadow:none!important;text-shadow:none!important}
html{font-size:80%}
a{color:inherit!important;text-decoration:underline!important}
a.bare,a[href^="#"],a[href^="mailto:"]{text-decoration:none!important}
a[href^="http:"]:not(.bare)::after,a[href^="https:"]:not(.bare)::after{content:"(" attr(href) ")";display:inline-block;font-size:.875em;padding-left:.25em}
abbr[title]{border-bottom:1px dotted}
abbr[title]::after{content:" (" attr(title) ")"}
pre,blockquote,tr,img,object,svg{page-break-inside:avoid}
thead{display:table-header-group}
svg{max-width:100%}
p,blockquote,dt,td.content{font-size:1em;orphans:3;widows:3}
h2,h3,#toctitle,.sidebarblock>.content>.title{page-break-after:avoid}
#header,#content,#footnotes,#footer{max-width:none}
#toc,.sidebarblock,.exampleblock>.content{background:none!important}
#toc{border-bottom:1px solid #dddddf!important;padding-bottom:0!important}
body.book #header{text-align:center}
body.book #header>h1:first-child{border:0!important;margin:2.5em 0 1em}
body.book #header .details{border:0!important;display:block;padding:0!important}
body.book #header .details span:first-child{margin-left:0!important}
body.book #header .details br{display:block}
body.book #header .details br+span::before{content:none!important}
body.book #toc{border:0!important;text-align:left!important;padding:0!important;margin:0!important}
body.book #toc,body.book #preamble,body.book h1.sect0,body.book .sect1>h2{page-break-before:always}
.listingblock code[data-lang]::before{display:block}
#footer{padding:0 .9375em}
.hide-on-print{display:none!important}
.print-only{display:block!important}
.hide-for-print{display:none!important}
.show-for-print{display:inherit!important}}
@media amzn-kf8,print{#header>h1:first-child{margin-top:1.25rem}
.sect1{padding:0!important}
.sect1+.sect1{border:0}
#footer{background:none}
#footer-text{color:rgba(0,0,0,.6);font-size:.9em}}
@media amzn-kf8{#header,#content,#footnotes,#footer{padding:0}}
</style>
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css">
<style>
/*! Stylesheet for CodeRay to loosely match GitHub themes | MIT License */
pre.CodeRay{background:#f7f7f8}
.CodeRay .line-numbers{border-right:1px solid;opacity:.35;padding:0 .5em 0 0;-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none}
.CodeRay span.line-numbers{display:inline-block;margin-right:.75em}
.CodeRay .line-numbers strong{color:#000}
table.CodeRay{border-collapse:separate;border:0;margin-bottom:0;background:none}
table.CodeRay td{vertical-align:top;line-height:inherit}
table.CodeRay td.line-numbers{text-align:right}
table.CodeRay td.code{padding:0 0 0 .75em}
.CodeRay .debug{color:#fff!important;background:navy!important}
.CodeRay .annotation{color:#007}
.CodeRay .attribute-name{color:navy}
.CodeRay .attribute-value{color:#700}
.CodeRay .binary{color:#509}
.CodeRay .comment{color:#998;font-style:italic}
.CodeRay .char{color:#04d}
.CodeRay .char .content{color:#04d}
.CodeRay .char .delimiter{color:#039}
.CodeRay .class{color:#458;font-weight:bold}
.CodeRay .complex{color:#a08}
.CodeRay .constant,.CodeRay .predefined-constant{color:teal}
.CodeRay .color{color:#099}
.CodeRay .class-variable{color:#369}
.CodeRay .decorator{color:#b0b}
.CodeRay .definition{color:#099}
.CodeRay .delimiter{color:#000}
.CodeRay .doc{color:#970}
.CodeRay .doctype{color:#34b}
.CodeRay .doc-string{color:#d42}
.CodeRay .escape{color:#666}
.CodeRay .entity{color:#800}
.CodeRay .error{color:#808}
.CodeRay .exception{color:inherit}
.CodeRay .filename{color:#099}
.CodeRay .function{color:#900;font-weight:bold}
.CodeRay .global-variable{color:teal}
.CodeRay .hex{color:#058}
.CodeRay .integer,.CodeRay .float{color:#099}
.CodeRay .include{color:#555}
.CodeRay .inline{color:#000}
.CodeRay .inline .inline{background:#ccc}
.CodeRay .inline .inline .inline{background:#bbb}
.CodeRay .inline .inline-delimiter{color:#d14}
.CodeRay .inline-delimiter{color:#d14}
.CodeRay .important{color:#555;font-weight:bold}
.CodeRay .interpreted{color:#b2b}
.CodeRay .instance-variable{color:teal}
.CodeRay .label{color:#970}
.CodeRay .local-variable{color:#963}
.CodeRay .octal{color:#40e}
.CodeRay .predefined{color:#369}
.CodeRay .preprocessor{color:#579}
.CodeRay .pseudo-class{color:#555}
.CodeRay .directive{font-weight:bold}
.CodeRay .type{font-weight:bold}
.CodeRay .predefined-type{color:inherit}
.CodeRay .reserved,.CodeRay .keyword{color:#000;font-weight:bold}
.CodeRay .key{color:#808}
.CodeRay .key .delimiter{color:#606}
.CodeRay .key .char{color:#80f}
.CodeRay .value{color:#088}
.CodeRay .regexp .delimiter{color:#808}
.CodeRay .regexp .content{color:#808}
.CodeRay .regexp .modifier{color:#808}
.CodeRay .regexp .char{color:#d14}
.CodeRay .regexp .function{color:#404;font-weight:bold}
.CodeRay .string{color:#d20}
.CodeRay .string .string .string{background:#ffd0d0}
.CodeRay .string .content{color:#d14}
.CodeRay .string .char{color:#d14}
.CodeRay .string .delimiter{color:#d14}
.CodeRay .shell{color:#d14}
.CodeRay .shell .delimiter{color:#d14}
.CodeRay .symbol{color:#990073}
.CodeRay .symbol .content{color:#a60}
.CodeRay .symbol .delimiter{color:#630}
.CodeRay .tag{color:teal}
.CodeRay .tag-special{color:#d70}
.CodeRay .variable{color:#036}
.CodeRay .insert{background:#afa}
.CodeRay .delete{background:#faa}
.CodeRay .change{color:#aaf;background:#007}
.CodeRay .head{color:#f8f;background:#505}
.CodeRay .insert .insert{color:#080}
.CodeRay .delete .delete{color:#800}
.CodeRay .change .change{color:#66f}
.CodeRay .head .head{color:#f4f}
</style>
</head>
<body class="article toc2 toc-left">
<div id="header">
<h1>Tei2html</h1>
<div class="details">
<span id="author" class="author">Jeroen Hellingman</span><br>
</div>
<div id="toc" class="toc2">
<div id="toctitle">Table of Contents</div>
<ul class="sectlevel2">
<li><a href="#_introduction">Introduction</a></li>
<li><a href="#_prerequisites_and_installation">Prerequisites and Installation</a></li>
<li><a href="#_required_downloads">Required Downloads</a></li>
<li><a href="#_configuration">Configuration</a></li>
<li><a href="#_processing_steps">Processing Steps</a></li>
<li><a href="#_configuration_2">Configuration</a></li>
<li><a href="#_the_tei_header">The TEI Header</a></li>
<li><a href="#_cover_pages">Cover Pages</a></li>
<li><a href="#_those_pesky_page_breaks">Those Pesky Page-Breaks</a></li>
<li><a href="#_figures">Figures</a></li>
<li><a href="#_tables">Tables</a></li>
<li><a href="#_notes">Notes</a></li>
<li><a href="#_mathematical_formulas">Mathematical formulas</a></li>
<li><a href="#_using_the_rend_attribute">Using the <code>@rend</code> attribute</a></li>
<li><a href="#_aligned_bilingual_text">Aligned Bilingual Text</a></li>
<li><a href="#_facsimile_support">Facsimile Support</a></li>
<li><a href="#_epub3_support">ePub3 Support</a></li>
<li><a href="#_media_overlays_in_epub3">Media-Overlays in ePub3</a></li>
<li><a href="#_coding_conventions">Coding Conventions</a></li>
<li><a href="#_tools">Tools</a>
<ul class="sectlevel2">
<li><a href="#_auxiliary_tools">Auxiliary Tools</a></li>
<li><a href="#_tools_to_generate_plain_text_files">Tools to generate plain text files</a></li>
<li><a href="#_tools_for_post_processing_pgdp_output">Tools for post-processing PGDP output</a></li>
<li><a href="#_tools_for_preparing_texts_for_pgdp">Tools for preparing texts for PGDP</a></li>
<li><a href="#_merging_texts">Merging Texts</a></li>
<li><a href="#_checking_a_tei_file">Checking a TEI file</a></li>
<li><a href="#_generating_a_kwic_index">Generating a KWIC index</a></li>
</ul>
</li>
<li><a href="#_future_ideas_2">Future Ideas</a>
<ul class="sectlevel2">
<li><a href="#_css_stylesheet_redesign_todo">CSS stylesheet redesign [TODO]</a></li>
<li><a href="#_parsing_css_experimental">Parsing CSS [Experimental]</a></li>
</ul>
</li>
</ul>
</div>
</div>
<div id="content">
<div class="sect2">
<h3 id="_introduction">Introduction</h3>
<div class="paragraph">
<p>The TEI format is the standard format for transcribing scholarly texts in humanities. Unlike common word-processing formats, TEI focuses on the semantics of text elements instead of the look-and-feel. This is great for research purposes, as it enables software to answer questions like "give me all citations in Shakespeare where Hamlet uses the past tense," (provided of course somebody has encoded that data) but makes it harder to produce nicely formatted output from the same source. This is where the <code>tei2html</code> stylesheets kick-in.</p>
</div>
<div class="paragraph">
<p><code>tei2html</code> is a collection of XSLT stylesheets that transform a duly marked up TEI file to an attractive HTML, ePub or PDF document. It is intended to work out-of-the-box with unadorned TEI files, but will be able to perform better if certain conventions are followed.</p>
</div>
<div class="paragraph">
<p>These guidelines describe the conventions for preparing TEI files such that they can successfully be converted by <code>tei2html</code>. They assume a working knowledge of the <a href="http://www.tei-c.org/Lite/teiu5_en.html">TEI Lite documentation</a>. They are inspired by, and often follow the <a href="http://uwdcc.library.wisc.edu/resources/etext/TEIGuidelines.shtml">Wisconsin University Guidelines for Markup of Electronic Texts</a>, which provides excellent examples of numerous issues. For real starters, a <a href="http://www.tei-c.org/Support/Learn/mueller-index.htm">very gentle introduction to the TEI markup language</a> is available.</p>
</div>
<div class="paragraph">
<p>Whether TEI is useful for you depends on your needs. If you are occasionally producing a text, and need to have it formatted, TEI and <code>tei2html</code> is probably not the way to go. If you have a large collection of texts, and need to maintain them for a long time, and would like to add numerous types of scholarly annotations to them, TEI certainly warrants serious consideration.</p>
</div>
<div class="paragraph">
<p>Originally, <code>tei2html</code> was developed to produce beautiful new editions of public domain texts for Project Gutenberg, but it can also be used for other TEI files.</p>
</div>
<div class="sect3">
<h4 id="_guiding_principles">Guiding Principles</h4>
<div class="paragraph">
<p>The design of <code>tei2html</code> is based on a small set of guiding principles and design decisions. These are some assumptions, that I believe are reasonable to expect when digitizing text for research and preservation.</p>
</div>
<div class="paragraph">
<p>The guiding principles are:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Tags supplement the plain text content of the transcribed work. They do not replace content. When all tags are removed from the file, the remaining text should reflect the original source text as much as possible. As a corollary to this principle, <code>tei2html</code> does not supply much content itself. Unless specifically asked to do so, it will not insert tables of content, headers, labels, etc.</p>
</li>
<li>
<p>Tags are semantic: they reflect as much as possible the function of a certain part of the text, not its appearance. This also means that <code>tei2html</code> needs to rely on a number of defaults and formatting hints to decide what things should ultimately look like in the output.</p>
</li>
<li>
<p>The <code>@rend</code>, <code>@style</code> and <code>@rendition</code> attributes in tags are intended as formatting indications only. Ignoring them fully or partially should not render a text incomprehensible. (Note that the TEI standard itself prescribes that these attributes should be used to indicate the formatting of the source, rather than the desired output.)</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>The design decisions are:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>The <code>@rend</code> attribute values are "rendition ladders" designed to map relatively directly to CSS format statements in the HTML version, however, they use a different syntax, and are also used for effects that are not supported by CSS, and are thus not copied verbatim.</p>
</li>
<li>
<p>The <code>@rend</code> attribute can also be used to refer to HTML classes, which can be defined as <code>&lt;rendition&gt;</code> elements in a <code>&lt;tagsDecl&gt;</code> section.</p>
</li>
<li>
<p>CSS can be imported from an external source, and attached to IDs or classes in the generated output. To make this workable, IDs in the source are passed to the output unchanged (when reasonable), and the generated classes are documented. Also, a class to be output can be specified in the <code>@rend</code> attribute.</p>
</li>
<li>
<p>Similarly, the value of <code>@style</code> attributes is copied verbatim to the CSS output; as are the content of <code>&lt;rendition&gt;</code> elements. Note that currently no translation of the <code>@selector</code> attribute of the <code>&lt;rendition&gt;</code> element takes place.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>As a result of these design decisions, a document can be neatly formatted with CSS with minimal rendering information 'polluting' the TEI master file. Note that to meet ePub restrictions on CSS, no inline (that is, in an attribute on an HTML element) CSS is generated.</p>
</div>
</div>
<div class="sect3">
<h4 id="_sgml_versus_xml">SGML versus XML</h4>
<div class="paragraph">
<p>Originally, TEI was defined in SGML. Since version P4, this TEI has moved on to XML. XML is a considerably simplified reincarnation of SGML. It does away with much of the complexity of SGML. However, TEI (and TEILite) was originally developed for SGML, and I started using TEI even before XML was conceived.</p>
</div>
<div class="paragraph">
<p>Although XML is simpler, and far more tools can deal with it, SGML is somewhat easier to type due to its more relaxed syntax rules. You don&#8217;t need to use quotes on all attribute values, nor need to provide close tags for all elements. For this reason, I normally produce my files in SGML. The conversion to XML is straightforward, and can (almost always) be fully automated. Since I am used to SGML, the examples in this document will be valid SGML snippets, but not necessarily well-formed XML.</p>
</div>
<div class="paragraph">
<p>Of course, you can work directly in XML instead of SGML, and the stylesheets are supposed to work with the P4 and P5 incarnations of TEI as well (although not all elements, even those of P3, are supported). Working in XML directly has a number of benefits as well:</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Directly viewable in most modern browsers (which can apply an XSLT transform on the fly; however, in practice, the <code>tei2html</code> stylesheets used here are too complex for a browser, and no current browser supports XSLT 3.0 directly. Javascript implementations do exist, but I have no experience with them).</p>
</li>
<li>
<p>No initial conversion tool required.</p>
</li>
<li>
<p>Can use embedded namespaces for other XML schemas.</p>
</li>
<li>
<p>Can use one or more of the various XML authoring tools available.</p>
</li>
</ol>
</div>
</div>
<div class="sect3">
<h4 id="_considerations_for_output_formats">Considerations for Output Formats</h4>
<div class="paragraph">
<p>TEI files are typically prepared from pre-existing sources, that is printed books, magazines or other textual works. In those cases, it may be desirable to not only to include the logical content of the work being transcribed, but also to describe the physical appearance of some aspects of the text. In that case, the <code>@rend</code>, <code>@style</code> and <code>@rendition</code> attributes can be used to record those aspects.</p>
</div>
<div class="paragraph">
<p>For many uses, a TEI file is not the most desirable format. For reading, it is far more convenient to have it available in some more presentation-oriented format. With <code>tei2html</code>, a TEI document can be converted to various output formats, which are:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>HTML for viewing in a browser on a PC.</p>
</li>
<li>
<p>ePub for reading on dedicated eBook readers.</p>
</li>
<li>
<p>Plain text for reading on simple devices (supported using Perl, but only in a fairly limited way that requires some manual cleanup).</p>
</li>
<li>
<p>PDF for printing on paper (supported using Prince-XML, using specially adjusted HTML output).</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>These output formats place some restrictions on the structure of the TEI file, described in the following usage conventions. These usage conventions are not enforced by the DTD.</p>
</div>
<div class="paragraph">
<p><em>References to page numbers.</em> In printed media, the page numbers produced in the output will differ from the source. To correctly replace page numbers in the source, each page number should be tagged as a reference (<code>ref</code> element) with <code>@type=pageref</code>. The tag should only enclose the page number itself, not any of the surrounding material. The transformation will replace the content of this tag with the actual number of the page the material referred to appears on. Almost always, the reference is not to the page itself, but to some element appearing on this page. For this reason, it is better not to link to the <code>pb</code> element, but to the element actually referred to. (In HTML output, the original page numbers will be shown in the margin and used in the text.)</p>
</div>
<div class="paragraph">
<p><em>Nesting of cross-references and anchors.</em> In HTML, it is impossible to nest anchors and cross-references. As a results, certain elements in the TEI source should not be nested, as these will result in invalid nested anchors in HTML. For example, the <code>ref</code> element should not contain <code>corr</code> elements (as the latter generates an anchor for the automatically generated errata list). The proper way to resolve this is to place the <code>ref</code> element inside the <code>corr</code> element.</p>
</div>
<div class="paragraph">
<p><em>Nesting of paragraphs.</em> In HTML, it is impossible to nest paragraphs. Usually, the transformation software will take this in account, and close (and re-open) open paragraphs in HTML when needed.</p>
</div>
<div class="paragraph">
<p>In a few other cases, the transformation may not result in entirely correct results. Always validate the result with tools such as <code>tidy</code> or <code>epubcheck</code>.</p>
</div>
</div>
<div class="sect3">
<h4 id="_special_characters_in_sgml_files">Special Characters in SGML files</h4>
<div class="paragraph">
<p>For XML files actually used by the XSLT stylesheets, any character encoding supported by XML/XSLT works. For SGML, the options are more limited.</p>
</div>
<div class="paragraph">
<p>Also, the pre-processing scripts in Perl can only deal with either pure 7-bit ASCII or the ISO 8859-1 character set. All characters outside those ranges are to be represented by character entities.</p>
</div>
<div class="paragraph">
<p>Use entities from the following sets:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>The standard SGML ISO 8859 entity sets.</p>
</li>
<li>
<p>The other declared entity sets that come with the TEI DTD.</p>
</li>
<li>
<p>Invent your own descriptive abbreviation. Always provide the Unicode code point for a character (if it exists) in the entity declaration, and provide the Unicode character name or a description in a comment. Please follow the pattern used by ISO where possible.</p>
</li>
<li>
<p>Numeric character entities, based on Unicode.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>For longer fragments in a non-Latin script, I normally use an ASCII based transliteration scheme, and supply tools (called <code>patc</code>) to convert these to Unicode. For documents completely a non-Latin script, it will probably be better to work with Unicode in a suitable editor (and using XML directly).</p>
</div>
<div class="sect4">
<h5 id="_fractions_entities">Fractions entities</h5>
<div class="paragraph">
<p>Fractions of one figure above and below.</p>
</div>
<div class="paragraph">
<p><code>&amp;frac12;</code></p>
</div>
<div class="paragraph">
<p>Fractions with more than one figure above or below.</p>
</div>
<div class="paragraph">
<p><code>&amp;frac3_16;</code>
<code>&amp;frac23_100;</code></p>
</div>
</div>
<div class="sect4">
<h5 id="_special_filling_characters_for_leaders">Special filling characters for leaders</h5>
<div class="paragraph">
<p><em>Future plan</em></p>
</div>
<div class="paragraph">
<p><code>&amp;dotfil;</code>
<code>&amp;dashfil;</code>
<code>&amp;linefil;</code>
<code>&amp;spacefil;</code></p>
</div>
<div class="paragraph">
<p>These are roughly equivalent to TeX&#8217;s special glue values.</p>
</div>
<div class="paragraph">
<p>Note: a better approach will be to use the <code>&lt;space&gt;</code> tag, with appropriate rendering information, e.g.</p>
</div>
<div class="listingblock">
<div class="content">
<pre>&lt;space @rend="leader(dotted)"/&gt;</pre>
</div>
</div>
<div class="paragraph">
<p>or</p>
</div>
<div class="listingblock">
<div class="content">
<pre>&lt;space dim="horizontal" @rend="leader(' &amp;ndash; ')"/&gt;</pre>
</div>
</div>
<div class="paragraph">
<p>As long the leader CSS this is not directly supported by browsers, we can use the method outlined here to render this in HTML: <a href="https://www.w3.org/Style/Examples/007/leaders.en.html" class="bare">https://www.w3.org/Style/Examples/007/leaders.en.html</a></p>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_prerequisites_and_installation">Prerequisites and Installation</h3>
<div class="paragraph">
<p>See the page on <a href="Installation.adoc">installation</a>.</p>
</div>
<div class="paragraph">
<p>Note that currently no installer is present, so you will need to get the code from the repository directly.</p>
</div>
<div class="sect3">
<h4 id="_running_from_the_command_line">Running from the command line</h4>
<div class="paragraph">
<p>Most of the interaction on the command line is with small Perl scripts that start the actual XSLT processor, and some other scripts.</p>
</div>
<div class="paragraph">
<p>Before you can run the Perl scripts, you will need to make sure the paths to the various executables are configured correctly. Perl should be able to find the place where youâ€™ve located your scripts (when running perl with the -S option.)</p>
</div>
<div class="paragraph">
<p>The various <code>.jar</code> files (for Saxon and epubcheck), and the SGML catalog files need to be located in a specific subdirectory of the directory where the perl scripts reside.</p>
</div>
</div>
<div class="sect3">
<h4 id="_running_interactively">Running interactively</h4>
<div class="paragraph">
<p>No easy window-based interface is yet available. I am working on a small HTML application to run the scripts interactively.</p>
</div>
</div>
<div class="sect3">
<h4 id="_running_with_oxygen">Running with Oxygen</h4>
<div class="paragraph">
<p>You can use the stylesheets with Oxygen, provided your sources are in XML format. Make sure you select an XSLT 3.0 processor to perform the transformation.</p>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_required_downloads">Required Downloads</h3>
<div class="paragraph">
<p>The <code>tei2html</code> code has a range of dependencies on third-party software. This page lists those.</p>
</div>
<div class="sect3">
<h4 id="_saxon">Saxon</h4>
<div class="paragraph">
<p>An XSLT 3.0 processor is required for <code>tei2html</code>, any XSLT 3.0 processor should work, however, I&#8217;ve developed these stylesheets with Saxon (using the freely available version Saxon HE).</p>
</div>
<div class="paragraph">
<p>You should download a reasonable recent version of Saxon-HE product from <a href="http://www.saxonica.com/products.html">saxonica.com</a>. I will take care <code>tei2html</code> will continue to work with the free versions of Saxon, no matter how tempting the additional features in the paid versions are (such as higher order functions, binary file handling, etc.)</p>
</div>
</div>
<div class="sect3">
<h4 id="_java">Java</h4>
<div class="paragraph">
<p>Saxon-HE requires Java.</p>
</div>
<div class="paragraph">
<p>Make sure the java executables can be found on the path.</p>
</div>
<div class="paragraph">
<p>If you do not have Java, you can download it from <a href="http://java.com/en/" class="bare">http://java.com/en/</a></p>
</div>
</div>
<div class="sect3">
<h4 id="_perl">Perl</h4>
<div class="paragraph">
<p>If you are planning to use the provided Perl scripts to glue things together, you will need a Perl interpreter.</p>
</div>
<div class="paragraph">
<p>For Windows, my advice is to download <a href="http://strawberryperl.com/">Strawberry Perl</a>. Use either the 32 or 64 bits version, to match your system.</p>
</div>
<div class="paragraph">
<p><em>Note</em> Upgrading Strawberry Perl does not work properly: please save-guard local installations in your site directory before upgrading, as the uninstaller will throw those files away.</p>
</div>
<div class="sect4">
<h5 id="_packages_used">Packages used</h5>
<div class="ulist">
<ul>
<li>
<p>Image::Size</p>
</li>
<li>
<p>Lingua::BO::Wylie (Only for Tibetan support: download from <a href="https://www.thlib.org/reference/transliteration/wyconverter.php">www.thlib.org</a>)</p>
</li>
<li>
<p>HTML::Entities;</p>
</li>
<li>
<p>Text::Levenshtein::XS</p>
</li>
<li>
<p>Statistics::Descriptive</p>
</li>
<li>
<p>File::Basename</p>
</li>
<li>
<p>Getopt::Long</p>
</li>
<li>
<p>Image::Info</p>
</li>
<li>
<p>MIME::Base64</p>
</li>
<li>
<p>XML::XPath</p>
</li>
<li>
<p>Unicode::Normalize</p>
</li>
<li>
<p>Roman</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>If you are missing a package, it can easily be installed using CPAN: <code>cpan install &lt;package&gt;</code>.</p>
</div>
<div class="paragraph">
<p>After installation, copy the files <code>LanguageNames.pm</code> and <code>SgmlSupport.pm</code> to the local site library (e.g., <code>Strawberry\perl\site\lib</code>).</p>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_sx_nsgml">SX, NSGML</h4>
<div class="paragraph">
<p><em>Optional, only needed you want to use SGML as source format.</em></p>
</div>
<div class="paragraph">
<p>SX is an SGML to XML translator, and NSGML is an SGML validator, part of the SP package. Since XSLT only supports XML, you will need both those two tools to be able to work with SGML. They can be downloaded from <a href="http://www.jclark.com/">James Clark website</a>. For windows, get <a href="ftp://ftp.jclark.com/pub/sp/win32/sp1_3_4.zip">sp 1.3.4</a>.</p>
</div>
<div class="paragraph">
<p>To enable SX and NSGML to understand your document types, you need to configure a catalog of DTDs (Which maps public DTDs to local resources containing their definitions). The scripts assume this is located in a file named <code>dtd/CATALOG</code>.</p>
</div>
<div class="paragraph">
<p>You will need to add the <code>teilite.dtd</code> to the CATALOG. This DTD can be found here: <a href="http://www.tei-c.org/Vault/P4/Lite/DTD/" class="bare">http://www.tei-c.org/Vault/P4/Lite/DTD/</a></p>
</div>
<div class="paragraph">
<p>A short explanation of Catalog files can be found in the SP documentation on James Clarkâ€™s website referenced above.</p>
</div>
<div class="paragraph">
<p>As an alternative to SX and NSGML, you can use osx and onsgml from the OpenJade Project. These are slightly more up-to-date. You will have to update
the names in the main <code>tei2html.pl</code> script in that case.</p>
</div>
</div>
<div class="sect3">
<h4 id="_zip">ZIP</h4>
<div class="paragraph">
<p>To compress ePub files, you will need a zip utility. <code>tei2html</code> uses <a href="http://www.info-zip.org/Zip.html">info-zip</a> to handle the peculiar requirements of the ePub format. (See e.g., <a href="http://www.snee.com/bobdc.blog/2008/03/creating-epub-files.html">this blog entry on creating ePub files</a>.)</p>
</div>
</div>
<div class="sect3">
<h4 id="_node_js">Node.js</h4>
<div class="paragraph">
<p><em>Optional, only needed when you use mathematical formulas in TeX notation.</em></p>
</div>
<div class="paragraph">
<p>To convert mathematical formulas in TeX format to a format that can be included in static HTML pages, you will need to install the following:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Node.js (see the <a href="https://nodejs.org/en/">node.js website</a>).</p>
</li>
<li>
<p>mathjax-node-cli (<a href="https://github.com/mathjax/mathjax-node-cli">source at GitHub</a>), most conveniently installed by using <code>npm</code> after installing Node.js.</p>
</li>
</ul>
</div>
</div>
<div class="sect3">
<h4 id="_patc">Patc</h4>
<div class="paragraph">
<p><em>Optional, only needed when you use the transcription schemes for non-Latin scripts I use in SGML.</em></p>
</div>
<div class="paragraph">
<p>Patc (pattern changer) is a small utility written in C to do multiple find-and-replace actions at once. You will need a C compiler to get it to work. It enables you to execute multiple find-replace actions in an efficient way. Mostly used to change the transliteration of non-Roman scripts I&#8217;ve used. If you don&#8217;t use that, youâ€™ll not need it. (Iâ€™ve successfully compiled this on a variety of platforms, including Unix, and Windows; a solution file for Visual Studio 7.0 is included; contact me if you need a Windows binary. A make file for use with linux is also included.)</p>
</div>
</div>
<div class="sect3">
<h4 id="_epubcheck">epubcheck</h4>
<div class="paragraph">
<p><em>Optional, only needed if you want to check generated ePubs.</em></p>
</div>
<div class="paragraph">
<p>Epubcheck is a tool to validate epub books, it can be obtained from: <a href="https://github.com/IDPF/epubcheck" class="bare">https://github.com/IDPF/epubcheck</a>. Note that <code>tei2html</code> doesn&#8217;t automatically generate correct ePubs: you can still do a lot of things that make ePubs non-conform, for example by including CSS3 constructs, or referring to resources in CSS and not including them in the ePub spine manually.</p>
</div>
<div class="paragraph">
<p>This tool also requires Java; the scripts assume you use <code>epubcheck-3.0.1.jar</code>, placed in the tools/lib subdirectory.</p>
</div>
</div>
<div class="sect3">
<h4 id="_prince_xml">Prince XML</h4>
<div class="paragraph">
<p><em>Optional, only needed if you want generated PDF output.</em></p>
</div>
<div class="paragraph">
<p>Note that Prince is a commercial product; a free version can be used for strictly private purposes, and downloaded from: <a href="https://www.princexml.com/" class="bare">https://www.princexml.com/</a>. The free version does include a small icon on the first page to promote Prince. Shouldn&#8217;t be a big nuisance.</p>
</div>
</div>
<div class="sect3">
<h4 id="_xsltdoc">XSLTdoc</h4>
<div class="paragraph">
<p><em>Optional, only needed if you want to browse through the documentation of the code.</em></p>
</div>
<div class="paragraph">
<p>You can clone XSLTdoc (at time of writing version 1.3.3) from <a href="https://github.com/XSLTdoc/XSLTdoc">GitHub</a>, where you can also find the <a href="https://xsltdoc.github.io">documentation</a>.</p>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_configuration">Configuration</h3>
<div class="sect3">
<h4 id="_environment_variables">Environment variables</h4>
<div class="paragraph">
<p>To run <code>tei2html</code> from the command line, it will be practical to configure several environment variables, that is:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>set <code>TEI2HTML_HOME</code> to the location of the checked-out <code>tei2html</code> directory.</p>
</li>
<li>
<p>set <code>SAXON_HOME</code> to the location where Saxon is installed.</p>
</li>
<li>
<p>(<em>optional</em>) set <code>PRINCE_HOME</code> to the location where Prince is installed.</p>
</li>
</ul>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_processing_steps">Processing Steps</h3>
<div class="paragraph">
<p>For my internal processing, I follow a number of steps to go from my master TEI file to HTML or ePub output. These are described here.</p>
</div>
<div class="sect3">
<h4 id="_step_1_convert_from_sgml_to_xml_optional">Step 1: Convert from SGML to XML (<em>Optional</em>)</h4>
<div class="paragraph">
<p>Most of my TEI files are in (old-school) SGML format with the '.tei' extension. This needs to be converted to XML, before XSLT wants to do anything with it.</p>
</div>
<div class="sect4">
<h5 id="_step_1_1_convert_transcriptions_to_sgml_entities">Step 1.1: Convert transcriptions to SGML entities.</h5>
<div class="paragraph">
<p>Some of my TEI files include snippets of non-Latin script in various transcription formats. These need to be converted to SGML entities (either named or numeric) before we can actually transform to XML. For this, I use a 'patc' tool that will change such transcriptions. For each transcription, a separate run is needed. The <code>tei2html.pl</code> script will check for such transcriptions, and run the right patc tool as needed. (For most text, this is irrelevant.)</p>
</div>
</div>
<div class="sect4">
<h5 id="_step_1_2_convert_to_xml">Step 1.2: Convert to XML.</h5>
<div class="paragraph">
<p>The actual SGML to XML conversion is achieved by running the James Clark&#8217;s SX tool.</p>
</div>
</div>
<div class="sect4">
<h5 id="_step_1_3_normalize_case">Step 1.3: Normalize case.</h5>
<div class="paragraph">
<p>Use Sebastian Rahtz' <code>tei2tei.xsl</code> stylesheet to use the proper casing for TEI elements. After this step, the TEI should be valid TEI (according to TEI P4) in XML form. The <code>tei2html</code> stylesheets should be able to deal with the text now.</p>
</div>
</div>
<div class="sect4">
<h5 id="_step_1_5_convert_to_tei_p5_optional">Step 1.5: Convert to TEI P5. (<em>Optional</em>)</h5>
<div class="paragraph">
<p>Use Sebastian Rahtz' <code>p4top5.xsl</code> stylesheet to convert the TEI P4 to TEI P5. The <code>tei2html</code> stylesheets should still be able to deal with the text, although I&#8217;ve not extensively tested this. The main distinction is that <code>div0</code> elements will have been changed to <code>div1</code> elements, and all underlying numbered <code>divX</code> elements have been 'elevated,' which impacts the appearance and breaking up into chunks when generating ePubs.</p>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_step_2_run_saxon_to_generate_html_and_epub">Step 2: Run Saxon to generate HTML and ePub</h4>
<div class="paragraph">
<p>Now that we have XML, we can apply the XSLT transformation on it. This will result in a single HTML output file. Here, again a few intermediate steps are needed.</p>
</div>
<div class="sect4">
<h5 id="_step_2_1_normalize_tables">Step 2.1: Normalize tables</h5>
<div class="paragraph">
<p>Table handling in TEI and HTML is complicated. To deal with them correctly, we have a separate XSLT stylesheet (<code>normalize-table.xsl</code>) that adds row and column numbers to cells in tables (leaving the rest of the XML untouched). With those numbers present, styling can be applied to tables more reliable. This script will also warn you when you have tables where the number of (effective, after dealing with cells that span multiple rows or cells) columns is different for each row.</p>
</div>
</div>
<div class="sect4">
<h5 id="_step_2_2_transform_to_html">Step 2.2: Transform to HTML</h5>
<div class="paragraph">
<p>After the tables have been normalised, we&#8217;re ready to transform to HTML. This is done by the main XSLT stylesheet <code>tei2html.xsl</code>, which pulls in the various partial stylesheets.</p>
</div>
</div>
<div class="sect4">
<h5 id="_step_2_3_transform_to_epub">Step 2.3: Transform to ePub</h5>
<div class="paragraph">
<p>Similar to the conversion to HTML, the conversion to ePub 3.0 is done with the XSLT stylesheet <code>tei2epub.xsl</code>, which re-uses most of the stylesheets used by <code>tei2html.xsl</code>. The results of this transform are placed in a directory which mirrors the internal structure of an ePub archive.</p>
</div>
</div>
<div class="sect4">
<h5 id="_step_2_4_package_epub">Step 2.4: Package ePub</h5>
<div class="paragraph">
<p>In a final step, the ePub files are compressed into a single zip file, following the conventions of an ePub container.</p>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_configuration_2">Configuration</h3>
<div class="paragraph">
<p>Currently, there are several options to change the generated output. These can be configured by using a file named <code>tei2html.config</code> in which various parameters can be set. If you add such a file to the directory where you TEI file is located, the <code>tei2html.pl</code> perl script will automatically pick it up.</p>
</div>
<div class="paragraph">
<p>It is only necessary to specify those items that differ from the default in your configuration file.</p>
</div>
<div class="sect3">
<h4 id="_current_status">Current Status</h4>
<div class="paragraph">
<p>The default configuration file is given below. Its actual value can be found in the <code>modules/configuration.xsl</code>.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="xml"><span class="tag">&lt;tei2html.config&gt;</span>
    <span class="tag">&lt;debug&gt;</span>false<span class="tag">&lt;/debug&gt;</span>                                            <span class="comment">&lt;!-- Use debug mode (uses CSS to color various elements in output HTML). --&gt;</span>
    <span class="tag">&lt;logLevel&gt;</span>INFO WARNING ERROR DEBUG<span class="tag">&lt;/logLevel&gt;</span>                   <span class="comment">&lt;!-- Log levels: DEBUG, INFO, WARNING, ERROR --&gt;</span>

    <span class="tag">&lt;debug.facsimile&gt;</span>false<span class="tag">&lt;/debug.facsimile&gt;</span>                        <span class="comment">&lt;!-- Insert links to the PGDP proofing images in the right margin --&gt;</span>

    <span class="tag">&lt;language&gt;</span>en-US<span class="tag">&lt;/language&gt;</span>                                      <span class="comment">&lt;!-- Main language of text (if not specified explicitly with the @lang attribute on the text element). --&gt;</span>
    <span class="tag">&lt;defaultLanguage&gt;</span>en-US<span class="tag">&lt;/defaultLanguage&gt;</span>                        <span class="comment">&lt;!-- Default language for localization. --&gt;</span>

    <span class="tag">&lt;drama.inline.speaker&gt;</span>false<span class="tag">&lt;/drama.inline.speaker&gt;</span>              <span class="comment">&lt;!-- Inline the speaker (default the speaker is a separate paragraph) --&gt;</span>

    <span class="tag">&lt;lb.preserve&gt;</span>true<span class="tag">&lt;/lb.preserve&gt;</span>                                 <span class="comment">&lt;!-- Preserve linebreaks indicate with the lb element. --&gt;</span>
    <span class="tag">&lt;lb.hyphen.remove&gt;</span>false<span class="tag">&lt;/lb.hyphen.remove&gt;</span>                      <span class="comment">&lt;!-- Remove hyphens before line-breaks. --&gt;</span>
    <span class="tag">&lt;lb.removable.hyphen&gt;</span><span class="entity">&amp;not;</span><span class="tag">&lt;/lb.removable.hyphen&gt;</span>                <span class="comment">&lt;!-- Character used for removable hyphen before a line-break (DTA convention). --&gt;</span>
    <span class="tag">&lt;lb.hyphen&gt;</span>-<span class="tag">&lt;/lb.hyphen&gt;</span>                                        <span class="comment">&lt;!-- Character used for non-removable hyphen before line-break. --&gt;</span>

    <span class="tag">&lt;toc.numberEntries&gt;</span>true<span class="tag">&lt;/toc.numberEntries&gt;</span>                     <span class="comment">&lt;!-- Provide numbers with generated TOC entries. --&gt;</span>
    <span class="tag">&lt;toc.defaultEntries&gt;</span>false<span class="tag">&lt;/toc.defaultEntries&gt;</span>                  <span class="comment">&lt;!-- Use generic heads in entries in the TOC, if no head is present. --&gt;</span>

    <span class="tag">&lt;pg.includeHeaders&gt;</span>false<span class="tag">&lt;/pg.includeHeaders&gt;</span>                    <span class="comment">&lt;!-- Include Project Gutenberg headers and footers. --&gt;</span>
    <span class="tag">&lt;pg.includeComments&gt;</span>false<span class="tag">&lt;/pg.includeComments&gt;</span>                  <span class="comment">&lt;!-- Include references to Project Gutenberg in comments. --&gt;</span>
    <span class="tag">&lt;pg.compliant&gt;</span>false<span class="tag">&lt;/pg.compliant&gt;</span>                              <span class="comment">&lt;!-- Only use HTML and CSS constructs that are compliant with to Project Gutenberg guidelines. --&gt;</span>

    <span class="tag">&lt;showParagraphNumbers&gt;</span>false<span class="tag">&lt;/showParagraphNumbers&gt;</span>              <span class="comment">&lt;!-- Output paragraph numbers, using the value of the @n attribute. --&gt;</span>
    <span class="tag">&lt;includeAlignedDivisions&gt;</span>true<span class="tag">&lt;/includeAlignedDivisions&gt;</span>         <span class="comment">&lt;!-- Include divisions indicated by &quot;align-with-document()&quot; --&gt;</span>
    <span class="tag">&lt;useRegularizedUnits&gt;</span>false<span class="tag">&lt;/useRegularizedUnits&gt;</span>                <span class="comment">&lt;!-- Use the regularized units specified in the measure-tag. (false: both are shown, the original in the text, the regularized units in a
                                                                         pop-up; true: regularized in text, original in pop-up) --&gt;</span>
    <span class="tag">&lt;xref.show&gt;</span>always<span class="tag">&lt;/xref.show&gt;</span>                                   <span class="comment">&lt;!-- Method used to generate external links, possible values:
                                                                         - always:   external links are active at the location in the text.
                                                                         - never:    external links are not shown (only the anchor text is).
                                                                         - colophon: external links are active in the colophon (including in the external-links table, if generated).
                                                                      --&gt;</span>
    <span class="tag">&lt;xref.table&gt;</span>false<span class="tag">&lt;/xref.table&gt;</span>                                  <span class="comment">&lt;!-- Collect all external links in a separate table in the colophon. --&gt;</span>
    <span class="tag">&lt;xref.exceptions&gt;</span>https://www.pgdp.net/; https://www.gutenberg.org/; pg:; music/; images/<span class="tag">&lt;/xref.exceptions&gt;</span>  <span class="comment">&lt;!-- Semicolon-separated list of external URLs than can be always be used. --&gt;</span>

    <span class="tag">&lt;punctuation.hanging&gt;</span>false<span class="tag">&lt;/punctuation.hanging&gt;</span>                <span class="comment">&lt;!-- Use hanging punctuation (by generating the relevant CSS classes. This requires tweaking, depending on the font used). --&gt;</span>

    <span class="tag">&lt;ditto.enable&gt;</span>true<span class="tag">&lt;/ditto.enable&gt;</span>                               <span class="comment">&lt;!-- Use ditto marks in ditto (deprecated) or seg[@copyOf] elements. --&gt;</span>
    <span class="tag">&lt;ditto.mark&gt;</span>,,<span class="tag">&lt;/ditto.mark&gt;</span>                                     <span class="comment">&lt;!-- The symbol to use as a ditto mark. May also be overridden by rend attribute ditto-mark() --&gt;</span>
    <span class="tag">&lt;ditto.repeat&gt;</span>word<span class="tag">&lt;/ditto.repeat&gt;</span>                               <span class="comment">&lt;!-- How often to use a ditto mark, possible values: word | segment. May also be overridden by rend attribute ditto-repeat() --&gt;</span>

    <span class="tag">&lt;pageNumbers.show&gt;</span>true<span class="tag">&lt;/pageNumbers.show&gt;</span>                       <span class="comment">&lt;!-- Show page numbers in the right margin. --&gt;</span>
    <span class="tag">&lt;pageNumbers.before&gt;</span>[<span class="tag">&lt;/pageNumbers.before&gt;</span>                      <span class="comment">&lt;!-- String to place before the page number in the right margin. --&gt;</span>
    <span class="tag">&lt;pageNumbers.after&gt;</span>]<span class="tag">&lt;/pageNumbers.after&gt;</span>                        <span class="comment">&lt;!-- String to place after the page number in the right margin. --&gt;</span>

    <span class="tag">&lt;facsimile.enable&gt;</span>false<span class="tag">&lt;/facsimile.enable&gt;</span>                      <span class="comment">&lt;!-- Output section with and links to facsimile images if required information is present. --&gt;</span>
    <span class="tag">&lt;facsimile.wrapper.enable&gt;</span>true<span class="tag">&lt;/facsimile.wrapper.enable&gt;</span>       <span class="comment">&lt;!-- Generate HTML wrapper files for the images, and link to these instead of to the image. --&gt;</span>
    <span class="tag">&lt;facsimile.path&gt;</span>page-images<span class="tag">&lt;/facsimile.path&gt;</span>                    <span class="comment">&lt;!-- Path where the HTML wrapper files will be generated. --&gt;</span>
    <span class="tag">&lt;facsimile.target&gt;</span><span class="tag">&lt;/facsimile.target&gt;</span>                           <span class="comment">&lt;!-- Value of the target attribute of generated links in HTML (leave empty for default; _blank, _top, _parent, _self). --&gt;</span>

    <span class="tag">&lt;notes.foot.returnArrow&gt;</span>true<span class="tag">&lt;/notes.foot.returnArrow&gt;</span>           <span class="comment">&lt;!-- Place a small up-arrow at the end of a footnote to return to the source location in the text. --&gt;</span>
    <span class="tag">&lt;notes.foot.counter&gt;</span>chapter<span class="tag">&lt;/notes.foot.counter&gt;</span>                <span class="comment">&lt;!-- At what level to count footnotes, possible values: chapter or text. --&gt;</span>
    <span class="tag">&lt;notes.apparatus.noteMarker&gt;</span><span class="entity">&amp;deg;</span><span class="tag">&lt;/notes.apparatus.noteMarker&gt;</span>  <span class="comment">&lt;!-- Note marker used with text-critical notes (coded with place=apparatus) used at location in text. --&gt;</span>
    <span class="tag">&lt;notes.apparatus.returnMarker&gt;</span><span class="entity">&amp;deg;</span><span class="tag">&lt;/notes.apparatus.returnMarker&gt;</span> <span class="comment">&lt;!-- Note marker used with text-critical notes (coded with place=apparatus) used before note, to return to text. --&gt;</span>
    <span class="tag">&lt;notes.apparatus.format&gt;</span>block<span class="tag">&lt;/notes.apparatus.format&gt;</span>          <span class="comment">&lt;!-- How to format text-critical notes: as separate paragraphs or as a single block. Possible values: paragraphs | block. --&gt;</span>

    <span class="tag">&lt;images.path&gt;</span><span class="tag">&lt;/images.path&gt;</span>                                     <span class="comment">&lt;!-- Prefix of path to images, relative to the HTML file --&gt;</span>
    <span class="tag">&lt;images.include&gt;</span>true<span class="tag">&lt;/images.include&gt;</span>                           <span class="comment">&lt;!-- Include images in the generated output. --&gt;</span>
    <span class="tag">&lt;images.requireInfo&gt;</span>true<span class="tag">&lt;/images.requireInfo&gt;</span>                   <span class="comment">&lt;!-- Require image-info to be present for an image (otherwise they won't be included in output) [TODO]. --&gt;</span>
    <span class="tag">&lt;images.scale&gt;</span>1.0<span class="tag">&lt;/images.scale&gt;</span>                                <span class="comment">&lt;!-- Image scale factor: 1.0 is normal size; 0.5 is half size; 2.0 is double size. --&gt;</span>
    <span class="tag">&lt;images.maxSize&gt;</span>100<span class="tag">&lt;/images.maxSize&gt;</span>                            <span class="comment">&lt;!-- Warn if image is larger than this number of kilobytes. --&gt;</span>
    <span class="tag">&lt;images.maxWidth&gt;</span>720<span class="tag">&lt;/images.maxWidth&gt;</span>                          <span class="comment">&lt;!-- Warn if image is wider than this number of pixels (after applying images.scale). --&gt;</span>
    <span class="tag">&lt;images.maxHeight&gt;</span>720<span class="tag">&lt;/images.maxHeight&gt;</span>                        <span class="comment">&lt;!-- Warn if image is taller than this number of pixels (after applying images.scale). --&gt;</span>

    <span class="tag">&lt;audio.useControls&gt;</span>false<span class="tag">&lt;/audio.useControls&gt;</span>                    <span class="comment">&lt;!-- Use controls for links to local audio (MP3, Midi, Ogg) formats (HTML5 only). --&gt;</span>

    <span class="tag">&lt;text.parentheses&gt;</span>()[]{}<span class="tag">&lt;/text.parentheses&gt;</span>                     <span class="comment">&lt;!-- Pairs of parentheses, first opening, then closing. --&gt;</span>
    <span class="tag">&lt;text.quotes&gt;</span><span class="entity">&amp;ldquo;</span><span class="entity">&amp;rdquo;</span><span class="entity">&amp;lsquo;</span><span class="entity">&amp;rsquo;</span><span class="entity">&amp;laquo;</span><span class="entity">&amp;raquo;</span><span class="entity">&amp;bdquo;</span><span class="entity">&amp;rdquo;</span><span class="tag">&lt;/text.quotes&gt;</span> <span class="comment">&lt;!-- Pairs of quotation marks, first opening, then closing. --&gt;</span>
    <span class="tag">&lt;text.curlyApos&gt;</span>true<span class="tag">&lt;/text.curlyApos&gt;</span>                           <span class="comment">&lt;!-- Replace a plain apostrophe (') with a right single quote. --&gt;</span>
    <span class="tag">&lt;text.spaceQuotes&gt;</span>true<span class="tag">&lt;/text.spaceQuotes&gt;</span>                       <span class="comment">&lt;!-- Insert a hair space between consecutive quotation marks. --&gt;</span>
    <span class="tag">&lt;text.useEllipses&gt;</span>true<span class="tag">&lt;/text.useEllipses&gt;</span>                       <span class="comment">&lt;!-- Replace three consecutive periods with an ellipsis character. --&gt;</span>
    <span class="tag">&lt;text.useIJLigature&gt;</span>false<span class="tag">&lt;/text.useIJLigature&gt;</span>                  <span class="comment">&lt;!-- Replace ij with the ij-ligature (Dutch and letter-spaced text only). --&gt;</span>
    <span class="tag">&lt;text.normalizeUnicode&gt;</span>true<span class="tag">&lt;/text.normalizeUnicode&gt;</span>             <span class="comment">&lt;!-- Normalize Unicode to NFC (may break Hebrew or Tibetan text in some rare cases) --&gt;</span>
    <span class="tag">&lt;text.abbr&gt;</span>i.e.; I.e.; e.g.; E.g.; A.D.; B.C.; P.M.; A.M.<span class="tag">&lt;/text.abbr&gt;</span> <span class="comment">&lt;!-- Common abbreviations, list separated by semicolons. --&gt;</span>

    <span class="tag">&lt;table.classifyContent&gt;</span>false<span class="tag">&lt;/table.classifyContent&gt;</span>            <span class="comment">&lt;!-- Attempt to determine the content-type of cells in a table; add relevant classes in the HTML output. --&gt;</span>

    <span class="tag">&lt;q.insertQuotes&gt;</span>false<span class="tag">&lt;/q.insertQuotes&gt;</span>                          <span class="comment">&lt;!-- Insert quotation marks around &lt;q&gt; markup based on first two pairs in setting &lt;text.quotes&gt;. --&gt;</span>
    <span class="tag">&lt;q.asDiv&gt;</span>true<span class="tag">&lt;/q.asDiv&gt;</span>                                         <span class="comment">&lt;!-- Render the &lt;q&gt; element with a div if true, as a span otherwise. --&gt;</span>

    <span class="tag">&lt;beta.convert&gt;</span>false<span class="tag">&lt;/beta.convert&gt;</span>                              <span class="comment">&lt;!-- Interpret beta-codes if the language is classical Greek (i.e., @xml:lang=&quot;grc&quot;). --&gt;</span>
    <span class="tag">&lt;beta.caseSensitive&gt;</span>false<span class="tag">&lt;/beta.caseSensitive&gt;</span>                  <span class="comment">&lt;!-- Beta-code is case-sensitive (i.e., not using the * notation for capital letters) --&gt;</span>

    <span class="tag">&lt;css.stylesheet&gt;</span>style/arctic.css<span class="tag">&lt;/css.stylesheet&gt;</span>               <span class="comment">&lt;!-- Default CSS stylesheet(s) to include; these are distributed with tei2html in the style directory. --&gt;</span>
    <span class="tag">&lt;css.useCommon&gt;</span>true<span class="tag">&lt;/css.useCommon&gt;</span>                             <span class="comment">&lt;!-- Use the build-in stylesheets (for screen) --&gt;</span>
    <span class="tag">&lt;css.useCommonPrint&gt;</span>true<span class="tag">&lt;/css.useCommonPrint&gt;</span>                   <span class="comment">&lt;!-- Use the build-in stylesheets (for print media) --&gt;</span>
    <span class="tag">&lt;css.useCommonAural&gt;</span>false<span class="tag">&lt;/css.useCommonAural&gt;</span>                  <span class="comment">&lt;!-- Use the build-in stylesheets (for aural support) --&gt;</span>
    <span class="tag">&lt;css.inline&gt;</span>true<span class="tag">&lt;/css.inline&gt;</span>                                   <span class="comment">&lt;!-- use an inline (embedded in HTML) stylesheet; ignored for ePub. --&gt;</span>
    <span class="tag">&lt;css.support&gt;</span>2<span class="tag">&lt;/css.support&gt;</span>                                    <span class="comment">&lt;!-- Level of support for CSS: used to filter out newer features. Possible values: 2 | 3. --&gt;</span>
    <span class="tag">&lt;css.frakturFont&gt;</span>Walbaum-Fraktur<span class="tag">&lt;/css.frakturFont&gt;</span>              <span class="comment">&lt;!-- The font to use when font(fraktur) is specified. --&gt;</span>
    <span class="tag">&lt;css.blackletterFont&gt;</span>UnifrakturMaguntia<span class="tag">&lt;/css.blackletterFont&gt;</span>   <span class="comment">&lt;!-- The font to use when font(blackletter) is specified. --&gt;</span>

    <span class="tag">&lt;rendition.id.prefix&gt;</span><span class="tag">&lt;/rendition.id.prefix&gt;</span>                     <span class="comment">&lt;!-- Prefix used for rendition IDs. --&gt;</span>

    <span class="tag">&lt;colophon.showEditDistance&gt;</span>true<span class="tag">&lt;/colophon.showEditDistance&gt;</span>     <span class="comment">&lt;!-- Show the Levenshtein edit distance in the list of corrections made in the colophon. --&gt;</span>
    <span class="tag">&lt;colophon.showCorrections&gt;</span>true<span class="tag">&lt;/colophon.showCorrections&gt;</span>       <span class="comment">&lt;!-- Show a list of corrections in the colophon. --&gt;</span>
    <span class="tag">&lt;colophon.showSuggestedCorrections&gt;</span>false<span class="tag">&lt;/colophon.showSuggestedCorrections&gt;</span> <span class="comment">&lt;!-- Show a list of suggested (but not applied) corrections in the colophon. --&gt;</span>
    <span class="tag">&lt;colophon.showMinorCorrections&gt;</span>true<span class="tag">&lt;/colophon.showMinorCorrections&gt;</span> <span class="comment">&lt;!-- Include minor corrections in the colophon. --&gt;</span>
    <span class="tag">&lt;colophon.showAbbreviations&gt;</span>true<span class="tag">&lt;/colophon.showAbbreviations&gt;</span>   <span class="comment">&lt;!-- Show a list of abbreviations in the colophon. --&gt;</span>
    <span class="tag">&lt;colophon.showExternalReferences&gt;</span>true<span class="tag">&lt;/colophon.showExternalReferences&gt;</span>   <span class="comment">&lt;!-- Show a section on external references in the colophon. --&gt;</span>
    <span class="tag">&lt;colophon.maxCorrectionCount&gt;</span>20<span class="tag">&lt;/colophon.maxCorrectionCount&gt;</span>   <span class="comment">&lt;!-- Maximum number of identical corrections that will be listed individually in the list of corrections. --&gt;</span>

    <span class="tag">&lt;math.decimalSeparator&gt;</span>.<span class="tag">&lt;/math.decimalSeparator&gt;</span>
    <span class="tag">&lt;math.thousandsSeparator&gt;</span>,<span class="tag">&lt;/math.thousandsSeparator&gt;</span>
    <span class="tag">&lt;math.numberPattern&gt;</span>^[0-9]{1,3}(,[0-9]{3})*(\.[0-9]+)?$<span class="tag">&lt;/math.numberPattern&gt;</span>
    <span class="tag">&lt;math.label.position&gt;</span>right<span class="tag">&lt;/math.label.position&gt;</span>
    <span class="tag">&lt;math.label.before&gt;</span>(<span class="tag">&lt;/math.label.before&gt;</span>
    <span class="tag">&lt;math.label.after&gt;</span>)<span class="tag">&lt;/math.label.after&gt;</span>
    <span class="tag">&lt;math.keepTexInComment&gt;</span>true<span class="tag">&lt;/math.keepTexInComment&gt;</span>
    <span class="tag">&lt;math.filePath&gt;</span>formulas<span class="tag">&lt;/math.filePath&gt;</span>                         <span class="comment">&lt;!-- Path where tei2html will write tex files and read SVG files. --&gt;</span>
    <span class="tag">&lt;math.htmlPath&gt;</span>formulas<span class="tag">&lt;/math.htmlPath&gt;</span>                         <span class="comment">&lt;!-- Path the generated HTML (and ePub) will use as location for included SVG or PNG files. --&gt;</span>

    <span class="tag">&lt;math.mathJax.format&gt;</span>SVG+IMG<span class="tag">&lt;/math.mathJax.format&gt;</span>                      <span class="comment">&lt;!-- Options: MathJax; MML; SVG; SVG+IMG --&gt;</span>
    <span class="tag">&lt;math.mathJax.configuration&gt;</span>TeX-MML-AM_SVG<span class="tag">&lt;/math.mathJax.configuration&gt;</span> <span class="comment">&lt;!-- Options for MathJax format, e.g.: TeX-MML-AM_SVG TeX-MML-AM_CHTML, see https://docs.mathjax.org/en/latest/config-files.html#common-configurations --&gt;</span>

    <span class="comment">&lt;!-- Output-format specific settings: these override the general settings defined above for a specific output format. Supported formats: &quot;html&quot;, &quot;html5&quot; and &quot;epub&quot;. --&gt;</span>
    <span class="tag">&lt;output</span> <span class="attribute-name">format</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">html</span><span class="delimiter">&quot;</span></span><span class="tag">&gt;</span>
        <span class="tag">&lt;useMouseOverPopups&gt;</span>true<span class="tag">&lt;/useMouseOverPopups&gt;</span>           <span class="comment">&lt;!-- Use mouse-over pop-ups on various items (links, etc). --&gt;</span>
    <span class="tag">&lt;/output&gt;</span>
    <span class="tag">&lt;output</span> <span class="attribute-name">format</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">html5</span><span class="delimiter">&quot;</span></span><span class="tag">&gt;</span>
        <span class="tag">&lt;useMouseOverPopups&gt;</span>true<span class="tag">&lt;/useMouseOverPopups&gt;</span>
    <span class="tag">&lt;/output&gt;</span>
    <span class="tag">&lt;output</span> <span class="attribute-name">format</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">epub</span><span class="delimiter">&quot;</span></span><span class="tag">&gt;</span>
        <span class="tag">&lt;useMouseOverPopups&gt;</span>false<span class="tag">&lt;/useMouseOverPopups&gt;</span>
        <span class="tag">&lt;xref.show&gt;</span>always<span class="tag">&lt;/xref.show&gt;</span>
        <span class="tag">&lt;xref.table&gt;</span>true<span class="tag">&lt;/xref.table&gt;</span>

        <span class="tag">&lt;pageNumbers.show&gt;</span>false<span class="tag">&lt;/pageNumbers.show&gt;</span>
        <span class="tag">&lt;includeAlignedDivisions&gt;</span>false<span class="tag">&lt;/includeAlignedDivisions&gt;</span>

        <span class="tag">&lt;math.mathJax.format&gt;</span>MML<span class="tag">&lt;/math.mathJax.format&gt;</span>
    <span class="tag">&lt;/output&gt;</span>
<span class="tag">&lt;/tei2html.config&gt;</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>This can also be found <code>configuration.xsl</code>.</p>
</div>
</div>
<div class="sect3">
<h4 id="_future_ideas">Future Ideas</h4>
<div class="ulist">
<ul>
<li>
<p>Use Mouseover pop-ups. (for showing corrections, etc.)</p>
</li>
<li>
<p>Include images (Y/N/All/Important)</p>
</li>
<li>
<p>Image path (<code>&lt;path&gt;</code>)</p>
</li>
<li>
<p>Footnote location (Page/Chapter/Work)</p>
</li>
<li>
<p>Generate colophon (Y/N)</p>
</li>
<li>
<p>Generate a table of contents (Front/Back/None)</p>
</li>
<li>
<p>Additional CSS stylesheets (<code>&lt;name&gt;</code>)</p>
</li>
<li>
<p>Generate marginal page-numbers (Y/N)</p>
</li>
<li>
<p>Generate links to page-images (Y/N)</p>
</li>
</ul>
</div>
</div>
<div class="sect3">
<h4 id="_things_that_can_be_handled_via_css">Things that can be handled via CSS</h4>
<div class="ulist">
<ul>
<li>
<p>Default table alignment (Left/Right/Center)</p>
</li>
<li>
<p>Default verse alignment (Left/Right/Center)</p>
</li>
</ul>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_the_tei_header">The TEI Header</h3>
<div class="paragraph">
<p>The TEI header (<code>&lt;teiHeader&gt;</code>) contains information about the text and the sources it is derived from. This metadata is grouped in various sections, in which it is often possible to distinguish information related to the electronic file from that related to the original source.</p>
</div>
<div class="paragraph">
<p><code>tei2html</code> uses the metadata in the TEI header to construct the meta-data in the target formats, as well as the optional colophon. It is important to correctly specify the metadata in the TEI header.</p>
</div>
<div class="paragraph">
<p>Preparing a TEI header is less work than it might seem, as you can normally work from a template, prepared with the most common elements already in place.</p>
</div>
<div class="paragraph">
<p>The TEI header contains four main sections:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="xml">    <span class="tag">&lt;teiHeader&gt;</span>
        <span class="tag">&lt;fileDesc&gt;</span>...<span class="tag">&lt;/fileDesc&gt;</span>
        <span class="tag">&lt;encodingDesc&gt;</span>...<span class="tag">&lt;/encodingDesc&gt;</span>
        <span class="tag">&lt;profileDesc&gt;</span>...<span class="tag">&lt;/profileDesc&gt;</span>
        <span class="tag">&lt;revisionDesc&gt;</span>...<span class="tag">&lt;/revisionDesc&gt;</span>
    <span class="tag">&lt;/teiHeader&gt;</span></code></pre>
</div>
</div>
<div class="sect3">
<h4 id="_the_file_description">The File Description</h4>
<div class="paragraph">
<p>The first element of the TEI header is the file description, <code>&lt;fileDesc&gt;</code>. This contains the most important meta-data in three main elements, the <code>&lt;titleStmt&gt;</code>, <code>&lt;publicationStmt&gt;</code>, and <code>&lt;sourceDesc&gt;</code>. Our template looks like this.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="xml">    <span class="tag">&lt;fileDesc&gt;</span>
        <span class="tag">&lt;titleStmt&gt;</span>
            <span class="tag">&lt;title&gt;</span>TITLE<span class="tag">&lt;/title&gt;</span>
            <span class="tag">&lt;author&gt;</span>AUTHOR<span class="tag">&lt;/author&gt;</span>
        <span class="tag">&lt;/titleStmt&gt;</span>
        <span class="tag">&lt;publicationStmt&gt;</span>
            <span class="tag">&lt;publisher&gt;</span>Project Gutenberg<span class="tag">&lt;/publisher&gt;</span>
            <span class="tag">&lt;pubPlace&gt;</span>Urbana, Illinois, USA.<span class="tag">&lt;/pubPlace&gt;</span>
            <span class="tag">&lt;idno</span> <span class="attribute-name">type</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">PGNum</span><span class="delimiter">&quot;</span></span><span class="tag">&gt;</span>12345<span class="tag">&lt;/idno&gt;</span>
            <span class="tag">&lt;date&gt;</span>2010-01-31<span class="tag">&lt;/date&gt;</span>
            <span class="tag">&lt;availability&gt;</span>
                <span class="tag">&lt;p&gt;</span>Some statements on the availability and copyright status of the work.<span class="tag">&lt;/p&gt;</span>
            <span class="tag">&lt;/availability&gt;</span>
        <span class="tag">&lt;/publicationStmt&gt;</span>
        <span class="tag">&lt;sourceDesc&gt;</span>
        <span class="tag">&lt;bibl&gt;</span>
            <span class="tag">&lt;author&gt;</span>AUTHOR<span class="tag">&lt;/author&gt;</span>
            <span class="tag">&lt;title&gt;</span>TITLE<span class="tag">&lt;/title&gt;</span>
            <span class="tag">&lt;date&gt;</span>YEAR<span class="tag">&lt;/date&gt;</span>
        <span class="tag">&lt;/bibl&gt;</span>
        <span class="tag">&lt;/sourceDesc&gt;</span>
    <span class="tag">&lt;/fileDesc&gt;</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>You might notice that the TEI header contains the title and author information twice. This is intentional, as one refers to the title of the file, and one to the title of the source. For the title given in the <code>&lt;titleStmt&gt;</code>, some TEI recommendations suggest appending "an electronic transcription" to the original title. I think that is unnecessary, and will use the original title as given on the title page, or perhaps normalized in some fashion. For personal names, I always give them in the natural order, that is, without a comma, and optionally I will supply the vital dates in parentheses, for example, <code>&lt;author&gt;John Doe (1833-1901)&lt;/author&gt;</code>. You may add other elements allowed by TEI in this statement if needed.</p>
</div>
<div class="paragraph">
<p>In the publication statement, you can give some information on the publisher and the availability of the book. For typical Project Gutenberg publications, the information in the template is fine.</p>
</div>
<div class="paragraph">
<p>The following specific values can be used in the <code>&lt;publicationStmt&gt;</code> element to register the various ways the text is known at Project Gutenberg and elsewhere.</p>
</div>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 50%;">
<col style="width: 50%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top"><strong>ID type</strong></th>
<th class="tableblock halign-left valign-top"><strong>Used for</strong></th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>&lt;idno type=PGNum&gt;12345&lt;/idno&gt;</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The Project Gutenberg eBook number.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>&lt;idno type=PGDPProjectID&gt;project1234&lt;/idno&gt;</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The PGDP project number(s).</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>&lt;idno type=PGClearance&gt;1234name&lt;/idno&gt;</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The PG Clearance number.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>&lt;idno type=OCLC&gt;&lt;/idno&gt;</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">OCLC catalog number (worldcat).</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>&lt;idno type=OLN&gt;&lt;/idno&gt;</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Open Library catalog number.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>&lt;idno type=LCCN&gt;&lt;/idno&gt;</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Library of Congress Call Number.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>&lt;idno type=ISBN&gt;&lt;/idno&gt;</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The ISBN. Since ISBNs refer to specific manifestations of a work, this number typically refers to the ISBN of the source digitized. ISBNs have been in use since 1972, so it is unlikely many Project Gutenberg books have such a number. (you are not supposed to use the ISBN of the source here!)</p></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p>The <code>&lt;availability&gt;</code> element should include a short reference to the copyright status of the work. For most texts in Project Gutenberg, the following phrase will be appropriate: <em>Not copyrighted in the United States. If you live elsewhere please check the laws of your country before downloading this ebook.</em></p>
</div>
<div class="paragraph">
<p>In the <code>&lt;sourceDesc&gt;</code>, the title and author information appears again. This time, you should use the exact title and author names as given on the title page of the original work used to prepare your Project Gutenberg text. If the title on the spine or cover of the book differs, this may be noted, but the title page is leading.</p>
</div>
<div class="sect4">
<h5 id="_extensions_to_tei">Extensions to TEI</h5>
<div class="paragraph">
<p>The <code>@nfc</code> attribute on <code>&lt;title&gt;</code> elements is used to indicate the number of non-filing characters, used when sorting a title. Counted should be all characters up to the character on which the title should be sorted, including spaces.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="xml">    <span class="tag">&lt;title</span> <span class="attribute-name">nfc</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">4</span><span class="delimiter">&quot;</span></span><span class="tag">&gt;</span>The Return of the King<span class="tag">&lt;/title&gt;</span>
    <span class="tag">&lt;title</span> <span class="attribute-name">nfc</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">3</span><span class="delimiter">&quot;</span></span><span class="tag">&gt;</span>An Introduction to Mathematics<span class="tag">&lt;/title&gt;</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>The <code>@key</code> attribute on <code>&lt;author&gt;</code> and related elements is used to supply a sort key for a name. Typically, such sort keys would drop accents, such that they will sort in the expected place in lists.</p>
</div>
<div class="paragraph">
<p>I also use the <code>@ref</code> key to provide a link to the viaf.org authority file.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="xml">    <span class="tag">&lt;author</span> <span class="attribute-name">key</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">Rijn, Rembrandt Harmenszoon van</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">ref</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">http://viaf.org/viaf/64013650</span><span class="delimiter">&quot;</span></span><span class="tag">&gt;</span>Rembrandt van Rijn (1606-1669)<span class="tag">&lt;/author&gt;</span>
    <span class="tag">&lt;author</span> <span class="attribute-name">key</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">MacKenzee, John</span><span class="delimiter">&quot;</span></span><span class="tag">&gt;</span>John McKenzee<span class="tag">&lt;/author&gt;</span>
    <span class="tag">&lt;author</span> <span class="attribute-name">key</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">Hotel, Desire l'</span><span class="delimiter">&quot;</span></span><span class="tag">&gt;</span>DesirÃ© l'HÃ´tel<span class="tag">&lt;/author&gt;</span></code></pre>
</div>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_cover_pages">Cover Pages</h3>
<div class="paragraph">
<p>Older books where often sold in simple paper covers, often just repeating the information on the title page. It was expected that the buyer of the book would bind it (or more likely have it bound by a professional bookbinder). As a result, covers for older books are not standard, and often do not contain more than a short title on the spine. The practice of selling books in nice decorative covers started in the late nineteenth century. Including the original cover of the book as an illustration in the TEI version is often nice, and is also a great feature for ePub devices, which use cover images to generate thumbnails from.</p>
</div>
<div class="paragraph">
<p>When generating ePubs, <code>tei2html</code> expects the cover image to be indicated in a specific way in the front matter, using the exact `id`s as shown below:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="xml"><span class="tag">&lt;div1</span> <span class="attribute-name">id</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">cover</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">type</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">Cover</span><span class="delimiter">&quot;</span></span><span class="tag">&gt;</span>
<span class="tag">&lt;p&gt;</span><span class="tag">&lt;figure</span> <span class="attribute-name">id</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">cover-image</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">rend</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">image(images/front.jpg)</span><span class="delimiter">&quot;</span></span><span class="tag">/&gt;</span><span class="tag">&lt;/p&gt;</span>
<span class="tag">&lt;/div1&gt;</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>To make this work with the various ePub ebook readers, make this image 600 by 800 pixels, preferably as full color JPG.</p>
</div>
<div class="paragraph">
<p>When a cover image is missing, a title page image can be used instead, as long as it is encoded following this convention (again, the `id`s matter, not the file names):</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="xml"><span class="tag">&lt;div1</span> <span class="attribute-name">id</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">titlepage</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">type</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">Titlepage</span><span class="delimiter">&quot;</span></span><span class="tag">&gt;</span>
<span class="tag">&lt;p&gt;</span><span class="tag">&lt;figure</span> <span class="attribute-name">id</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">titlepage-image</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">rend</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">image(images/titlepage.png)</span><span class="delimiter">&quot;</span></span><span class="tag">/&gt;</span><span class="tag">&lt;/p&gt;</span>
<span class="tag">&lt;/div1&gt;</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>See also: <a href="http://blog.threepress.org/2009/11/20/best-practices-in-epub-cover-images/" class="bare">http://blog.threepress.org/2009/11/20/best-practices-in-epub-cover-images/</a></p>
</div>
<div class="sect3">
<h4 id="_cover_thumbnail">Cover Thumbnail</h4>
<div class="paragraph">
<p>Sometimes it makes sense to also have a cover thumbnail which isn&#8217;t just a reduction of the (original) cover page. To do this, just specify (as a hack) <code>cover-thumbnail(imagefile)</code> in the rend attribute of the text element. Similarly, <code>cover-image(imagefile)</code> can be used to specify a cover image that is not part of the original book, for those who like to have both.</p>
</div>
</div>
<div class="sect3">
<h4 id="_favicon">favicon</h4>
<div class="paragraph">
<p>Simply drop an image file named <code>favicon.jpg</code> in the images directory, and <code>tei2html</code> will generate the metadata in the HTML to use it. Use a square image, upto 192 x 192 pixels.</p>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_those_pesky_page_breaks">Those Pesky Page-Breaks</h3>
<div class="paragraph">
<p>Printed books have pages, and thus page-breaks every couple of hundred words or so. Electronic files do not have this concept, but since pages and page numbers have traditionally been used to refer to passages in books, they can be captured in <code>&lt;pb&gt;</code> elements, which, for good reason, can appear almost anywhere in a TEI document. Here is where the trouble starts.</p>
</div>
<div class="paragraph">
<p>Reference:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>TEI P5 Documentation <a href="https://www.tei-c.org/release/doc/tei-p5-doc/en/html/ref-pb.html">pb</a></p>
</li>
</ul>
</div>
<div class="sect3">
<h4 id="_encoding">Encoding</h4>
<div class="paragraph">
<p>When a page-break occurs between two divisions, it can be encoded in various was, <em>e.g.</em>, before the closing tag:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="xml"><span class="tag">&lt;pb</span> <span class="attribute-name">n</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">123</span><span class="delimiter">&quot;</span></span><span class="tag">/&gt;</span>
<span class="tag">&lt;/div1&gt;</span>
<span class="tag">&lt;div1&gt;</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>Between the closing and opening tag:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="xml"><span class="tag">&lt;/div1&gt;</span>
<span class="tag">&lt;pb</span> <span class="attribute-name">n</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">123</span><span class="delimiter">&quot;</span></span><span class="tag">/&gt;</span>
<span class="tag">&lt;div1&gt;</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>After the opening tag:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="xml"><span class="tag">&lt;/div1&gt;</span>
<span class="tag">&lt;div1&gt;</span>
<span class="tag">&lt;pb</span> <span class="attribute-name">n</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">123</span><span class="delimiter">&quot;</span></span><span class="tag">/&gt;</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>Various guidelines for TEI propose different (conflicting) conventions for each option. The <code>tei2html</code> scripts all assume the first option (before the closing tag) This way, the generated tables of content, etc., refer to page-number that is current when the <code>&lt;div1&gt;</code> tag occurs.</p>
</div>
<div class="paragraph">
<p>It should be very well possible to write a small XSLT script to normalize this usage, avoiding complications in the other XSLT scripts.</p>
</div>
</div>
<div class="sect3">
<h4 id="_page_images">Page Images</h4>
<div class="paragraph">
<p>See <a href="FacsimileSupport.adoc">facsimile support</a></p>
</div>
</div>
<div class="sect3">
<h4 id="_cross_references">Cross-References</h4>
<div class="paragraph">
<p>As mentioned, cross-references in printed books often reference to page numbers. The easiest way to encode this is to do something like this:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>For details &lt;ref target="pb123"&gt;see page 123&lt;/ref&gt;.</pre>
</div>
</div>
<div class="paragraph">
<p>However, there are several problems with this approach:</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>This reference refers to a <code>&lt;pb id=&quot;pb123&quot; n=&quot;123&quot;/&gt;</code> somewhere in text. Now, of course, the reference is almost never to the page-break itself, but always to some content that appears on that page (a picture, a paragraph or phrase), but actually identifying and linking to the content referred to can be a time-consuming task, so is often postponed (think, for example, about a pre-existing index). So we often have texts that just link like this.</p>
</li>
<li>
<p>The reference contains more than just the page number. This makes it harder to replace the page number with the actual page number in paged output, if such is generated.</p>
</li>
<li>
<p>The reference does not make clear that it is indeed to a page number (which could hint the rendering process to replace it when rendering on paged media).</p>
</li>
</ol>
</div>
<div class="paragraph">
<p>For these reasons, <code>tei2html</code> specifies that references to page-numbers are tagged as:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>For details see page &lt;ref target="pb123" type="pageref"&gt;123&lt;/ref&gt;.</pre>
</div>
</div>
<div class="paragraph">
<p>That is, directly surrounding the page number, and the additional <code>@type</code> attribute set to pageref. This indicates to the rendering application that the content of the <code>&lt;ref&gt;</code> element needs to be replaced with the actual page number on which the details appear.</p>
</div>
<div class="paragraph">
<p>To prevent that the details do not appear on the indicated page, but on a previous or next page, you should replace the target with the non-<code>&lt;pb&gt;</code> element the details are really in (most likely a paragraph).</p>
</div>
<div class="paragraph">
<p>When creating new paged output, we will have to deal with yet another set of issues:</p>
</div>
<div class="paragraph">
<p>First, exact values for cross-references can only be established when final pagination is known. In some cases, this may result in changes in the page layout inducing changes in the page numbers itself ("see page 100" is wider than "see page 99"). Most current layout tools can deal with this type of issues reasonably, although in some extreme cases this still pops up.</p>
</div>
<div class="paragraph">
<p>Second, when generating an index, you want to avoid things like</p>
</div>
<div class="literalblock">
<div class="content">
<pre>common entry, 12, 12, 12, 23, 24, 25, 45.</pre>
</div>
</div>
<div class="paragraph">
<p>but summarize them as</p>
</div>
<div class="literalblock">
<div class="content">
<pre>common entry 12, 23-25, 45.</pre>
</div>
</div>
<div class="paragraph">
<p>which is not supported by most current index generating tools, and is pretty hard to do as well. (<code>tei2html</code> does this when referring to pre-existing page-numbers, but this is not very useful for paged output.)</p>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_figures">Figures</h3>
<div class="sect3">
<h4 id="_figures_according_to_tei_p3">Figures according to TEI P3</h4>
<div class="paragraph">
<p>Currently, <code>tei2html</code> supports figures following the TEI P3-model, with some modifications.</p>
</div>
<div class="paragraph">
<p>A <code>figure</code> element describes a single image, and optional some heading, legend text and a description.</p>
</div>
<div class="paragraph">
<p>The way the image itself was left somewhat implementation dependent. Within the structure of SGML, it could be specified as an entity, which was hardly supported anywhere. <code>tei2html</code> worked around this by deriving the image file from the <code>@id</code>, using an additional attribute <code>@url</code>, or placing the image file name in a rendition ladder in the <code>@rend</code> attribute.</p>
</div>
</div>
<div class="sect3">
<h4 id="_figures_according_to_tei_p5">Figures according to TEI P5</h4>
<div class="paragraph">
<p>TEI P5 revised the figure model, introducing a graphic element, and allowing multiple graphics to be part of a single figure. This better matches with practices in books, but requires a revision of the code.</p>
</div>
<div class="paragraph">
<p>The new model allows multiple graphics in a figure and specifies the attribute <code>@url</code> as the way to specify the image.</p>
</div>
</div>
<div class="sect3">
<h4 id="_adjustments_to_code">Adjustments to Code</h4>
<div class="paragraph">
<p>The current code should remain functional for existing texts.</p>
</div>
<div class="ulist">
<ul>
<li>
<p>When a single <code>graphic</code> element appears in a figure, behavior should be the same as an P3 style <code>figure</code> with an attribute, that is, the width of the block is the width of the image. (DONE.)</p>
</li>
<li>
<p>When multiple <code>graphic</code> elements appear, the images should be rendered under each other; the width of the entire block being the widest of these images.</p>
</li>
</ul>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_tables">Tables</h3>
<div class="paragraph">
<p>Tables are supported in <code>tei2html</code> with the following features:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>cells spanning multiple rows and columns, with the <code>@rows</code> and <code>@cols</code> attributes.</p>
</li>
<li>
<p>table headers, when rows are marked as <code>label</code> or <code>unit</code> on the <code>@role</code> attribute.</p>
</li>
<li>
<p>formatting of borders via predefined CSS classes. The following classes are defined, to be applied (in the <code>@rend</code> attribute) on the <code>table</code> element:</p>
</li>
<li>
<p><code>borderOutside</code>: the table is surrounded by a single box.</p>
</li>
<li>
<p><code>verticalBorderInside</code>: the columns are separated by vertical lines.</p>
</li>
<li>
<p><code>borderAll</code>: all cells are given a border. Outside borders and the border between the table head and table body are thicker.</p>
</li>
</ul>
</div>
<div class="sect3">
<h4 id="_columns">Columns</h4>
<div class="paragraph">
<p>In addition to the TEI model, <code>tei2html</code> supports column definitions. These can be used to apply styling to all cells in a column. The following elements are defined:</p>
</div>
<div class="paragraph">
<p><code>column</code>: a column definition, which can have the following attributes: <code>@cols</code> the number of columns this column definition applies to, by default only a single column; <code>@rend</code> the rendering that should be applied to each cell in the column matching the position of the column definition.</p>
</div>
<div class="paragraph">
<p><code>columnGroup</code>: a group of column definitions, that can be repeated multiple times. A <code>columnGroup</code> should always have the attribute <code>@repeat</code> which indicates the number of times the column-group should be repeated.</p>
</div>
<div class="paragraph">
<p>Note that the <code>@rend</code> value <code>align(decimal)</code> triggers some special processing when generating HTML. Since HTML does not directly support alignment on the decimal separator, any column with <code>align(decimal)</code> will be split into two columns, with in the first the integer part of the numbers, and in the second the fractional part. CSS is used to make those parts align as expected.</p>
</div>
</div>
<div class="sect3">
<h4 id="_braces">Braces</h4>
<div class="paragraph">
<p>Sometimes, rows are preceded by a tall brace. <code>tei2html</code> will automatically generate HTML to include an image of a tall brace when a cell spans more than one row and only includes a single brace character.</p>
</div>
</div>
<div class="sect3">
<h4 id="_table_processing">Table processing</h4>
<div class="paragraph">
<p><code>tei2html</code> cannot directly process tables correctly. A number of pre-processing steps are required to correctly deal with the complexities tables introduce. These are handled in the xslt file <code>normalize-table.xsl</code>, which includes code to determine the correct column of each cell (taking into consideration spanned rows and columns) and the special handling of decimal alignment. The <code>tei2html.pl</code> perl script normally applies this transform to the XML before applying the main transform.</p>
</div>
<div class="paragraph">
<p>Nested tables are supported.</p>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_notes">Notes</h3>
<div class="paragraph">
<p><code>tei2html</code> supports various types of notes, that is:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>footnotes</p>
</li>
<li>
<p>marginal notes</p>
</li>
<li>
<p>endnotes</p>
</li>
<li>
<p>notes to tables</p>
</li>
<li>
<p>apparatus notes</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Each type is handled in a slightly different way.</p>
</div>
<div class="sect3">
<h4 id="_footnotes">Footnotes</h4>
<div class="paragraph">
<p>Notes, given in the element <code>&lt;note&gt;</code> are, by default, considered footnotes. That can be made explicit by adding <code>@place=&quot;foot&quot;</code></p>
</div>
<div class="paragraph">
<p>Footnotes appear at the bottom (or foot) of the page. Since HTML does not have the concept of a page, <code>tei2html</code> collects all footnotes at the end of the <code>div0</code> or <code>div1</code> element they appear in.</p>
</div>
<div class="paragraph">
<p>If this is undesired, you can also explicitly call for the footnotes to be rendered, by inserting a <code>&lt;divGen type=&quot;footnotes&quot;&gt;</code>, which will generate the footnotes in a generate section. If only the body of that section is desired, use <code>&lt;divGen type=&quot;footnotebody&quot;&gt;</code>.</p>
</div>
<div class="paragraph">
<p>Footnotes will be automatically numbered per division. In the text, a small superscript number will link to the actual footnote. This same number is rendered in front of the footnote, and will link back to the location in the text. A small up-arrow at the end of the footnote will also link back to the text.</p>
</div>
<div class="paragraph">
<p>Sometimes, multiple footnote references on a page refer to the same footnote. This can be encoded using the <code>@sameAs</code> attribute, linking it to the <code>@id</code> of the referenced footnote. This way, multiple references can be made to the same footnote (using the same number). The up-arrow after such a duplicated note will be followed lower-case letters, each linking back to an instance of the note reference in the text.</p>
</div>
<div class="paragraph">
<p>If you want to override the automatically assigned note number, you can provide an alternative marker with <code>@rend=&quot;note-marker(*)&quot;</code>. Note that this will <em>not</em> change the generated number of other notes, that is, the note will still be counted [TODO: fix this].</p>
</div>
</div>
<div class="sect3">
<h4 id="_marginal_notes">Marginal notes.</h4>
<div class="paragraph">
<p><code>tei2html</code> support various types of marginal notes. The way they are placed in the margin in the HTML output is defined by various CSS rules. To indicate a note is a marginal note, use the <code>@place</code> attribute. This can have the following values:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>margin</code></p>
</li>
<li>
<p><code>left</code></p>
</li>
<li>
<p><code>right</code></p>
</li>
<li>
<p><code>cut-in-left</code></p>
</li>
<li>
<p><code>cut-in-right</code></p>
</li>
</ul>
</div>
<div class="paragraph">
<p>The top three options will place the note outside the text-block. The cut-in variants will place the note as a floating box inside the text-block of the main text.</p>
</div>
<div class="paragraph">
<p>Some care is need to prevent marginal notes to overlap each other. Simply don&#8217;t place them too close to each other (although that may not be an option when digitizing pre-existing books). It may help to widen the margin if needed.</p>
</div>
</div>
<div class="sect3">
<h4 id="_table_notes">Table notes.</h4>
<div class="paragraph">
<p>Notes that appear inside a table can be marked with <code>@place=&quot;table&quot;</code>. In that case, the notes will be rendered directly below the table, and numbered with lower-case letters, starting anew for each table.</p>
</div>
<div class="paragraph">
<p>Notes in tables not marked as table notes will be treated as footnotes to the division the table appears in.</p>
</div>
</div>
<div class="sect3">
<h4 id="_apparatus_notes">Apparatus notes.</h4>
<div class="paragraph">
<p>Text-critical works often include numerous notes linked to words or lines in the source text, indicating variant readings of the text in one or more editions being compared.</p>
</div>
<div class="paragraph">
<p>You can indicate apparatus notes with <code>@place=&quot;apparatus&quot;</code>. Notes marked thus will not be automatically rendered in the output, but require you request their rendering using <code>&lt;divGen type=&quot;apparatus&quot;&gt;</code>. At that location, all apparatus notes preceding this <code>divGen</code> will be rendered in a single paragraph (unless an apparatus notes contains multiple paragraphs itself).</p>
</div>
<div class="paragraph">
<p>All apparatus notes will be given the same reference symbol (by default a degree sign), which will be used to link the notes with their point of reference.</p>
</div>
<div class="paragraph">
<p>If you use multiple instances of <code>&lt;divGen type=&quot;apparatus&quot;&gt;</code>, multiple blocks of apparatus notes will be generated, each containing the notes before the block, but after the previously generated block.</p>
</div>
<div class="paragraph">
<p>TODO: support a better model for apparatus notes, as described in the TEI guidelines.</p>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_mathematical_formulas">Mathematical formulas</h3>
<div class="sect3">
<h4 id="_requirements">Requirements</h4>
<div class="paragraph">
<p>Use the suggested TEI notation: <code>&lt;formula id=f1 notation=&quot;TeX&quot;&gt;$E = mc^2$&lt;/formula&gt;</code> (see <a href="https://www.tei-c.org/release/doc/tei-p5-doc/en/html/FT.html#FTFOR">TEI guidelines</a>).</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Meet Project Gutenberg rules, that is convert to HTML and ePub without any dynamic content (that is, no javascript, no external fonts or dependencies on non-standard software, etc.)</p>
</li>
<li>
<p>Look as good as normal (dynamic) MathJax output.</p>
</li>
<li>
<p>Fully automated processing on command line (that is, it can be integrated in a build process).</p>
</li>
</ul>
</div>
</div>
<div class="sect3">
<h4 id="_implementation">Implementation</h4>
<div class="paragraph">
<p>The Project Gutenberg prohibition on active content make the direct use of MathJax impossible, so we need to follow a more complicated way to include mathematical formulas in text intended for PG.</p>
</div>
<div class="paragraph">
<p>The process consists of three steps:</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Run <code>tei2html</code> to let XSLT export all formulas into separate <code>.tex</code> files in a directory <code>formulas</code>. This is done during normal processing.</p>
</li>
<li>
<p>Run the perl script <code>convertFormulas.pl</code> to convert all these files to SVG files (and MathML).</p>
</li>
<li>
<p>Run <code>tei2html</code> again (if needed with the <code>-f</code> option) to include the generated SVG files as images (or inline) in the resulting file, and use metrics from the SVG files to generate proper CSS.</p>
</li>
</ol>
</div>
<div class="paragraph">
<p>The resulting output files are placed in a folder <code>formulas</code>, and named according to the following naming scheme <code>(inline|display)-&lt;ID&gt;.tex</code>. The name is important, as the conversion script uses that to determine the correct MathJax option to use when converting the file to SVG, etc.</p>
</div>
<div class="paragraph">
<p>The script <code>convertFormulas.pl</code> will convert these files to files named <code>(inline|display)-&lt;ID&gt;.svg</code>. This script will use node.js with mathjax-node-cli to produce HTML, SVG, and MathML files from the exported formulas.</p>
</div>
</div>
<div class="sect3">
<h4 id="_configuration_3">Configuration</h4>
<div class="paragraph">
<p>The following configuration options are available:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>math.mathJax.format</code> determines the way mathJax is used to generate math. Possible values:</p>
<div class="ulist">
<ul>
<li>
<p><code>MathJax</code>: use MathJax dynamically (loading javascript libraries)</p>
</li>
<li>
<p><code>MML</code>: use inline MathML notation (generated by mathjax-node-cli)</p>
</li>
<li>
<p><code>SVG</code>: use inline SVG (generated by mathjax-node-cli)</p>
</li>
<li>
<p><code>SVG+IMG</code>: use SVG files, included using an HTML <code>img</code> tag.</p>
</li>
</ul>
</div>
</li>
<li>
<p><code>math.mathJax.configuration</code> determines the MathJax configuration to use (only when the <code>MathJax</code> format is used).</p>
</li>
<li>
<p><code>math.label.position</code> determines the place where equation numbers are placed (valid values: <code>left</code> and <code>right</code>).</p>
</li>
<li>
<p><code>math.label.before</code> string to be placed before the equation number (default a left parenthesis).</p>
</li>
<li>
<p><code>math.label.after</code> string to be place dafter the equation number (default a right parenthesis).</p>
</li>
</ul>
</div>
</div>
<div class="sect3">
<h4 id="_installation_of_tools">Installation of tools</h4>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>install <a href="https://nodejs.org/en/">Node.js</a>. Make sure to install both node.js and npm.</p>
</li>
<li>
<p>install <a href="https://github.com/mathjax/mathjax-node">Mathjax-node</a> using <code>npm install -g mathjax-node</code>.</p>
</li>
<li>
<p>install <a href="https://github.com/mathjax/mathjax-node-cli">Mathjax-node-cli</a> using <code>npm install -g mathjax-node-cli</code>.</p>
</li>
</ol>
</div>
</div>
<div class="sect3">
<h4 id="_implementation_details">Implementation details</h4>
<div class="sect4">
<h5 id="_baseline_correction">Baseline correction</h5>
<div class="paragraph">
<p>The baseline is stored in the SVG files generated by MathJax. They can be read from the SVG file, using Xpath <code>/svg/@style</code>, and then parsing for the CSS value <code>vertical-align</code>. Similarly, the width and height can be retrieved from <code>/svg/@width</code> and <code>/svg/@height/</code>, and need to be set in CSS. All this CSS should apply to the <code>&lt;img&gt;</code> tag, to make sure that the SVG image is rendered at the correct size and on the proper baseline.</p>
</div>
<div class="paragraph">
<p>The spoken version is also encoded in the MathJax generated SVG file, using Xpath, <code>/svg/title</code>, and needs to be extracted, and set in the <code>@title</code> attribute of the image (or a surrounding span) to be visible as a pop-up.</p>
</div>
<div class="paragraph">
<p>Some articles about finding the baseline (that didn&#8217;t contain the obvious solution that the information is available in the SVG file itself):</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p><a href="https://tex.stackexchange.com/questions/44486/pixel-perfect-vertical-alignment-of-image-rendered-tex-snippets/45621" class="bare">https://tex.stackexchange.com/questions/44486/pixel-perfect-vertical-alignment-of-image-rendered-tex-snippets/45621</a></p>
</li>
<li>
<p><a href="https://www.princexml.com/forum/topic/2971/using-mathjax-with-princexml" class="bare">https://www.princexml.com/forum/topic/2971/using-mathjax-with-princexml</a></p>
</li>
</ol>
</div>
</div>
<div class="sect4">
<h5 id="_deduplication">Deduplication</h5>
<div class="paragraph">
<p>Often, the same formula appears multiple times in the same document. It makes sense to only generate a single SVG file for each formula, and include it multiple times.</p>
</div>
</div>
<div class="sect4">
<h5 id="_trivial_math">Trivial math</h5>
<div class="paragraph">
<p>Very often, a single letter or digit is (correctly) marked as an equation. To avoid needless use of MathJax, we can simply render those trivial expressions directly in HTML, and thus for some texts reduce the number of invocations of MathJax dramatically. Be aware that in this case, the appearance of letters in such trivial equations may differ from those in more complex equations, due to differences in font rendering and the way SVG is handled by browsers.</p>
</div>
</div>
<div class="sect4">
<h5 id="_labeled_equations">Labeled equations</h5>
<div class="paragraph">
<p>Numbered equations have a label (between parentheses) set flush-right. Here we use the label encoded on <code>@n</code> attribute, format it, and place it flush right. The configuration setting <code>math.label.position</code> (with possible values <code>left</code> and <code>right</code>) can be used to determine whether the label should go to the left or right edge of the text. (Note that to maintain centering, a label will be generated on both sides of the display formula in any case, and either the right or the left will be made invisible.)</p>
</div>
<div class="paragraph">
<p>Since we cannot have further mark-up in the values of attributes, we use a 'light' markup syntax to use italics and bold on labels. To get 1*a*, type <code>1_a_</code>; to get 2<strong>b</strong>, type <code>2<em>b</em></code>. Parenthesis can be supplied, based on the setting <code>math.label.before</code> and <code>math.label.after</code>.</p>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_open_issues">Open Issues</h4>
<div class="olist arabic">
<ol class="arabic">
<li>
<p><em>Unexpected Line breaks.</em> Currently, we see linebreaks directly after the HTML <code>&lt;span&gt;</code>, even when punctuation marks directly follow the math. We will probably have to wrap the entire formula and the following punctuation in a no-wrap <code>&lt;span&gt;</code> to prevent this. A simple work-around is to put the final punctuation inside the equation.</p>
</li>
<li>
<p><em>Punctuation after labeled display math.</em> Some books place punctuation after the label to end a sentence or phrase. With the current implementation, this is very tricky to emulate. Placing the punctuation after the formula is the most logical from a semantic point of view, but will require a lot of effort. As a work-around place this punctuation within the displayed equation.</p>
</li>
<li>
<p><em>No line-breaks.</em> Since browsers rendering HTML cannot break SVG into lines, math formulas will not be broken into lines. You may consider breaking very long formulas into multiple fragments as a measure of last resort.</p>
</li>
</ol>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_using_the_rend_attribute">Using the <code>@rend</code> attribute</h3>
<div class="paragraph">
<p>The <code>@rend</code> attribute is a simple hook into the TEI structure to document or specify how features are rendered. Within <code>tei2html</code> they can be used to achieve certain formatting effects. This feature should be used with moderation. Several ways of using the <code>@rend</code> attribute can be distinguished.</p>
</div>
<div class="paragraph">
<p>Note that according to the TEI Guidelines, the rendering attributes are intended to describe the presentation of the source material, and are not to prescribe any presentation of the output. Since the intention here is to faithfully reproduce text, this distinction is not really important for <code>tei2html</code>.</p>
</div>
<div class="sect3">
<h4 id="_simple">Simple</h4>
<div class="paragraph">
<p>Simple rendering attribute values provide single keywords to provide a rendering hint. This type of usage is sufficient most of the time. The pre-defined rendering keywords are often element specific, and should be considered as hints only, that is, ignoring the rend attribute should not render the document illegible.</p>
</div>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 50%;">
<col style="width: 50%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top"><strong>Element</strong></th>
<th class="tableblock halign-left valign-top"><strong>Recognized <code>@rend</code> values</strong></th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>hi</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>italic</code> (<em>default</em>) <code>bold</code> <code>bi</code> <code>sc</code> <code>asc</code> <code>sup</code> <code>sub</code> <code>ex</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>figure</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>center</code> (<em>default</em>) <code>left</code> <code>right</code> <code>inline</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>p</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>block</code> <code>center</code> <code>left</code> (<em>default</em>) <code>right</code> <code>indent</code> <code>noindent</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>q</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>block</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>list</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>number</code> <code>bullet</code> <code>none</code> (<em>default</em>)</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><em>Any</em></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>rtl</code> <code>ltr</code> (<em>see section below on directionality</em>)</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><em>Any</em></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><em>Any</em> (<em>these will be added to the class attribute of the output element in HTML</em>)</p></td>
</tr>
</tbody>
</table>
</div>
<div class="sect3">
<h4 id="_rendition_ladders">Rendition Ladders</h4>
<div class="paragraph">
<p>A slightly more powerful mechanism is provided by so-called 'rendering ladders', in which a number of key-value pairs are provided. These take the form <code>key(value)</code>, and multiple can be present in a <code>@rend</code> attribute. They are either translated to CSS, or given a specific meaning, sometimes depending on the element they are applied to.</p>
</div>
<div class="sect4">
<h5 id="_css_equivalents">CSS equivalents</h5>
<div class="paragraph">
<p>In most cases, rendition ladders are one-on-one translated to equivalent CSS rules. For example, the following snippet of TEI:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>&lt;p rend="font-style(italic) text-align(left)"&gt;A left-aligned paragraph in italics.&lt;/p&gt;</pre>
</div>
</div>
<div class="paragraph">
<p>Will be translated to the following HTML:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>&lt;p class="x12345"&gt;A left-aligned paragraph in italics.</pre>
</div>
</div>
<div class="paragraph">
<p>And the following CSS rule:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>.x12345 { font-style: italic; text-align: left; }</pre>
</div>
</div>
<div class="paragraph">
<p>Note that if the same value for the <code>@rend</code> attribute is used multiple times, only one CSS rule will be generated matching all occurrences (and the same class attribute will be used on each of them).</p>
</div>
</div>
<div class="sect4">
<h5 id="_special_interpretations">Special interpretations</h5>
<div class="paragraph">
<p>In a number of places, rendition ladders are interpreted by <code>tei2html</code> directly.</p>
</div>
<div class="paragraph">
<p>The following keys and values are supported: (Note that this list is not exhaustive, and the full list of options will be indicated with each element.)</p>
</div>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 25%;">
<col style="width: 25%;">
<col style="width: 25%;">
<col style="width: 25%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top"><strong>Element</strong></th>
<th class="tableblock halign-left valign-top"><strong>Key</strong></th>
<th class="tableblock halign-left valign-top"><strong>Value</strong></th>
<th class="tableblock halign-left valign-top"><strong>Example</strong></th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>text</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>stylesheet</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">name of CSS stylesheet, multiple stylesheets can be specified, separated by a comma</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>style/classic.css</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><em>Any</em></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>font</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>italic</code>, <code>bold</code>, <code>fsc</code> (full caps and smallcaps), <code>smallcaps</code>, <code>underlined</code>, <code>gothic</code> (note the difference from fall-through CSS)</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>&lt;hi rend=&quot;font(bold)&quot;&gt;</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>p</code>, <code>q</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>align</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>right</code>, <code>left</code>, <code>center</code>, <code>block</code> (that is, justified)</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>&lt;p rend=&quot;align(block)&quot;&gt;</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>p</code>, <code>l</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>indent</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The number characters to indent. The size of a character is not fixed, but is roughly the size of the letter m.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>&lt;l rend=&quot;indent(2)&quot;&gt;</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><em>Any</em></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>link</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">any url, rendered as link to the indicated url.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>&lt;figure rend=&quot;link(images/a.jpg)&quot;&gt;</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>figure</code>, <code>head</code>, <code>cell</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>image</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">any url, rendered as in-line image, obtained from the indicated url. When used on a <code>head</code> element, the image appears above the head, when used on a <code>cell</code> element, the image appears in the table-cell (typically used to pull in large braces spanning cells).</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>&lt;figure rend=&quot;image(images/a.jpg)&quot;&gt;</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>figure</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>float</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The place to float in image, table, etc. Possible values: left, right.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>&lt;figure rend=&quot;float(left)&quot;&gt;</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>figure</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>hover-overlay</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">In HTML output, when the mouse hovers over the image, the alternative image is shown (using CSS only).</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>&lt;figure rend=&quot;hover-overlay(images/overlay.jpg)&quot;&gt;</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>figure</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>image-frame</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">In HTML output, the image is placed centered on top of image specified as frame (using CSS positioning), such that the frame surrounds the image. For this, of course, the image with the frame should be larger than the image being framed.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>&lt;figure rend=&quot;image-frame(images/frame.jpg)&quot;&gt;</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>table</code>, <code>list</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>columns</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Set the element in multiple columns. May be applied to tables and lists.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>&lt;list rend=&quot;columns(2)&quot;&gt;&#8230;&#8203;&lt;/list&gt;</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>milestone</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>stars</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Render a milestone element with the indicated number of stars</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>&lt;milestone rend=&quot;stars(7)&quot;/&gt;</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><em>Any</em></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>class</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Sets a class attribute in the corresponding HTML output. This can be used in combination with custom CSS stylesheets to achieve special effects. (Note: just using the naming the class without following parenthesis in the rend attribute is now sufficient)</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>&lt;p rend=&quot;class(myClass)&quot;&gt;</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>l</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>hemistich</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Indents the current line with a certain space. When the value starts with a <code>^</code> followed by a number <em>n</em>, the content of the line <em>n</em> lines before is used, when the value starts with a <code>#</code> followed by an id, the content of the element with the id is used, otherwise, the literal content is used.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>&lt;l rend=&quot;hemistich(^1)&quot;&gt;</code>, <code>&lt;l rend=&quot;hemistich(#vs21)&quot;&gt;</code>, <code>&lt;l rend=&quot;hemistich(Content)&quot;&gt;</code></p></td>
</tr>
</tbody>
</table>
</div>
<div class="sect4">
<h5 id="_using_style_and_rendition">Using <code>@style</code> and <code>@rendition</code></h5>
<div class="paragraph">
<p>As an alternative to the <code>@rend</code> attribute, the current TEI guidelines also provide <code>@style</code> and <code>@rendition</code> to define presentation in a formally defined language. <code>tei2html</code> assumes that is CSS. See the <a href="http://www.tei-c.org/release/doc/tei-p5-doc/en/html/ref-att.global.rendition.html">TEI guidelines on rendition attributes</a>. Unlike the values of <code>@rend</code>, the specified CSS values are not interpreted at all, but passed to the output CSS directly.</p>
</div>
</div>
<div class="sect4">
<h5 id="_directionality">Directionality</h5>
<div class="paragraph">
<p>Since ePub does not allow CSS to be used for directionality, but requires that the HTML <code>@dir</code> attribute is used, the following <code>@rend</code> values are translated to a <code>@dir</code> attribute in HTML.</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p><code>direction(&#8230;&#8203;)</code></p>
</li>
<li>
<p><code>class(rtl)</code> and <code>class(ltr)</code> and the bare equivalents.</p>
</li>
</ol>
</div>
</div>
<div class="sect4">
<h5 id="_implementation_notes">Implementation notes:</h5>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Handle the <code>@style</code> attribute, and output it as a CSS rule.</p>
<div class="ulist">
<ul>
<li>
<p>generate a unique class name for the CSS fragment.</p>
</li>
<li>
<p>output the value of the <code>@style</code> attribute verbatim.</p>
</li>
<li>
<p>remove duplicates, such that identical <code>@style</code> attributes are only output once.</p>
</li>
<li>
<p>apply the generated class-name to the relevant output element in HTML.</p>
</li>
</ul>
</div>
</li>
<li>
<p>Handle the <code>@rendition</code> attribute.</p>
<div class="ulist">
<ul>
<li>
<p>apply the given class name(s) to the relevant output element in HTML.</p>
</li>
<li>
<p>verify <code>&lt;rendition&gt;</code> elements for the given class names are present in the <code>&lt;tagsDecl&gt;</code> of the TEI file.</p>
</li>
<li>
<p>warn if this is not the case.</p>
</li>
</ul>
</div>
</li>
<li>
<p>Handle the <code>&lt;rendition&gt;</code> tags in the <code>&lt;tagsDecl&gt;</code>.</p>
<div class="ulist">
<ul>
<li>
<p>verify the rendition id is used in the file.</p>
</li>
<li>
<p>output the corresponding CSS verbatim.</p>
</li>
</ul>
</div>
</li>
</ol>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_aligned_bilingual_text">Aligned Bilingual Text</h3>
<div class="paragraph">
<p>When you have a bilingual text, it is nice to show them side-by-side, such that the translations are aligned. Books sometimes places such bilingual texts on facing pages, but in an unpaged medium, that is not an option.</p>
</div>
<div class="paragraph">
<p>To present bilingual text side-by-side with the <code>tei2html</code>, you can do the following:</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Encode the two texts, each should be in a separate divisions (<code>div1</code>, <code>div2</code>, etc.).</p>
</li>
<li>
<p>Give each of the divisions an <code>@id</code> attribute.</p>
</li>
<li>
<p>On one of the divisions, add the following <code>@rend</code> attribute:</p>
<div class="literalblock">
<div class="content">
<pre>rend="align-with(id-of-div-to-align)"</pre>
</div>
</div>
</li>
<li>
<p>give each element in the first division with a unique <code>@n</code> attribute value. These can be numbers. The order is not really relevant, but it is easy to just number them sequentially.</p>
</li>
<li>
<p>give the matching elements in the second division the same <code>@n</code> attribute value as its counterpart in the first division. If an element has no counterpart, no <code>@n</code> attribute is needed.</p>
</li>
</ol>
</div>
<div class="paragraph">
<p>When running <code>tei2html</code>, it will generate a table, with the text of the first division on the left, and the text of the second division on the right. Table cells will be used to make sure matching elements are aligned. The code understands sub-divisions and will recurse into them, still using a single table.</p>
</div>
<div class="sect3">
<h4 id="_excluding_content_from_alignment">Excluding content from alignment</h4>
<div class="paragraph">
<p>Sometimes, you want to exclude certain elements from the alignment (e.g., non-translated sections, headings, or figures). To do so, you have to include the element on both sides with the same <code>@n</code> attribute, and give one the following <code>@rend</code> attribute:</p>
</div>
<div class="literalblock">
<div class="content">
<pre>rend="span-alignment(both)"</pre>
</div>
</div>
<div class="paragraph">
<p>The other element should remain empty (as it will be skipped).</p>
</div>
</div>
<div class="sect3">
<h4 id="_aligned_text_from_a_separate_file">Aligned text from a separate file</h4>
<div class="paragraph">
<p>It is also possible to align texts kept in separate files. To do so, use the following <code>@rend</code> attribute:</p>
</div>
<div class="literalblock">
<div class="content">
<pre>rend="align-with-document(filename.xml#id-of-div-to-align)"</pre>
</div>
</div>
<div class="paragraph">
<p>When using the perl scripts that come with <code>tei2html</code>, the to-be-aligned sections will be included in an intermediate document in a pre-processing step (in <code>include.xsl</code>), which replaces <code>align-with-document</code> with <code>align-with</code> and places the to-be aligned section directly after the section it will be aligned with. By doing so, generated tables of contents, lists of issues in the colophon, and footnotes will be processed correctly. The <code>tei2html</code> xslt stylesheeets can also do this directly, but with limited support for those additional items.</p>
</div>
</div>
<div class="sect3">
<h4 id="_footnotes_in_aligned_texts">Footnotes in aligned texts</h4>
<div class="paragraph">
<p>Footnotes in aligned text will be placed at the bottom of the column they appear in. If footnotes are present in both aligned texts, both sides will have footnotes.</p>
</div>
</div>
<div class="sect3">
<h4 id="_aligned_verse">Aligned verse</h4>
<div class="paragraph">
<p>When aligning verses (or actually line-groups, encoded with the <code>lg</code> element), there is no need to number matching lines with a <code>@n</code> attribute. However, the number of items in the line-groups needs to match. Again to align two line-groups, on one of the line-groups add the following <code>@rend</code> attribute:</p>
</div>
<div class="literalblock">
<div class="content">
<pre>rend="align-with(id-of-lg-to-align)"</pre>
</div>
</div>
<div class="paragraph">
<p>This will generate a table, in which all lines are placed in rows side-by-side. The code will recurse into nested <code>lg</code> elements, still using a single table.</p>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_facsimile_support">Facsimile Support</h3>
<div class="paragraph">
<p>TEI P5 contains a <a href="http://www.tei-c.org/release/doc/tei-p5-doc/en/html/ref-facsimile.html">facsimile element</a> to represent scanned documents, as well as some other features to better support facsimiles. These features can be used to link to the original scans.</p>
</div>
<div class="paragraph">
<p>Often scans are already available at some place on the web, and we may wish to point to them, sometimes, we wish to include them with our ebook, so we have two types of facsimiles: external images and internal images.</p>
</div>
<div class="paragraph">
<p>TEI offers two ways of referring to scanned facsimile images, one is using the <code>@facs</code> attribute on the <code>pb</code> element, the other is using <code>graphic</code> elements in a separate <code>facsimile</code> section. When using the latter option, the <code>@facs</code> attributes on the <code>pb</code> elements can also (and should) refer to those <code>graphic</code> elements.</p>
</div>
<div class="paragraph">
<p>The facsimile files themselves can be either hosted locally (on a file-system under our control) or remotely (with a third party). In the former case, we can generate self-contained ePubs with all the files on-board, in the later case, we have to make do with external references.</p>
</div>
<div class="paragraph">
<p>Finally, we can refer directly to the facsimiles, or generate an HTML wrapper that includes the facsimile (assumed to be an image in a supported format here). The HTML wrapper will be required if we include the facsimile images in an ePub file.</p>
</div>
<div class="paragraph">
<p>All combined, this gives several options to take into account when dealing with facsimile editions.</p>
</div>
<div class="sect3">
<h4 id="_facsimile_element">Facsimile Element</h4>
<div class="paragraph">
<p>The <code>facsimile</code> element is a top-level element, that describes a series of page images, and can stand independently of the transcribed text. This allows to specify just the metadata (in the Header) and the scans, to produce a digital facsimile.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="xml">   <span class="tag">&lt;facsimile&gt;</span>
      <span class="tag">&lt;graphic</span> <span class="attribute-name">id</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">facs123</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">url</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">p123.png</span><span class="delimiter">&quot;</span></span><span class="tag">/&gt;</span>
   <span class="tag">&lt;/facsimile&gt;</span></code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_facs_attribute"><code>@facs</code> Attribute</h4>
<div class="paragraph">
<p>The <code>@facs</code> attribute on <code>pb</code> elements can be used to point to scanned images of transcribed pages. This can be used to either link to some external source of page images (for example in the Internet Archive), or to link to an internal set of images (kept in a page-images subdirectory, for example).</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="xml">  <span class="tag">&lt;pb</span> <span class="attribute-name">n</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">123</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">facs</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">p123.png</span><span class="delimiter">&quot;</span></span><span class="tag">/&gt;</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>Let&#8217;s call this "direct" facsimile links.</p>
</div>
<div class="paragraph">
<p>Alternatively, it can link to an element in the <code>facsimile</code> element, for example:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="xml">  <span class="tag">&lt;pb</span> <span class="attribute-name">n</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">123</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">facs</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">#facs123</span><span class="delimiter">&quot;</span></span><span class="tag">/&gt;</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>Let&#8217;s call this "indirect" facsimile links.</p>
</div>
<div class="paragraph">
<p>This later case also allows pointing to zones within a page, but that is currently out-of-scope for <code>tei2html</code>.</p>
</div>
<div class="paragraph">
<p>The two ways should not be combined. Currently, the code only allows the "direct" way of linking to page images.</p>
</div>
</div>
<div class="sect3">
<h4 id="_comparison_of_direct_and_indirect_linking_to_facsimiles">Comparison of direct and indirect linking to facsimiles</h4>
<div class="sect4">
<h5 id="_direct">Direct</h5>
<div class="paragraph">
<p>Generate output wrapper file for each <code>pb</code>-element. <code>[DONE]</code></p>
</div>
<div class="paragraph">
<p>Generate links from HTML output to wrapper file. <code>[DONE]</code></p>
</div>
<div class="paragraph">
<p>Use location in text version defined by that <code>pb</code>-element to generate structural navigation aid (breadcrumbs) <code>[DONE]</code></p>
</div>
<div class="paragraph">
<p>Non-transcribed pages cannot be included (or we should encode additional <code>pb</code>-elements for those pages).</p>
</div>
</div>
<div class="sect4">
<h5 id="_indirect">Indirect</h5>
<div class="paragraph">
<p>Generate output wrapper file for each <code>graphic</code>-element. <code>[DONE]</code></p>
</div>
<div class="paragraph">
<p>Look-up referring <code>pb</code>-element to find location in text version to generate structural navigation aid. This may not be present, in which case we cannot use structural navigation guides (or use the next <code>graphic</code> element that does have a matching <code>pb</code>) <code>[DONE]</code></p>
</div>
<div class="paragraph">
<p>Generate links from HTML output to wrapper file, taking this into account. <code>[DONE]</code></p>
</div>
<div class="paragraph">
<p>Not all <code>graphic</code>-elements might be referred to by a <code>pb</code>-element. Need to decide what to do in this case, but probably using the next <code>graphic</code>-element that does have a matching <code>pb</code>-element is a good default strategy for producing navigational aids on those pages. <code>[TODO]</code></p>
</div>
<div class="paragraph">
<p>Need to deal with case that no text is present at all (that is, we have a TEI file with just a teiHeader and a facsimile element) <code>[TODO]</code></p>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_generated_output">Generated Output</h4>
<div class="sect4">
<h5 id="_html">HTML</h5>
<div class="paragraph">
<p>The output consists of a series of HTML pages, one per page, with some metadata in the heading of the page, and some navigational aids to conveniently jump to another page.</p>
</div>
<div class="paragraph">
<p>By convention, the facsimile images and wrapper pages will go into a directory <code>page-images</code>, and will look like this:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="html">  <span class="tag">&lt;html&gt;</span>
    <span class="tag">&lt;head&gt;</span>
      <span class="tag">&lt;title&gt;</span>Document title, page x<span class="tag">&lt;/title&gt;</span>
    <span class="tag">&lt;/head&gt;</span>
    <span class="tag">&lt;body&gt;</span>
      <span class="tag">&lt;div</span> <span class="attribute-name">class</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">facsimile-header</span><span class="delimiter">&quot;</span></span><span class="tag">&gt;</span>
         <span class="tag">&lt;h1&gt;</span>Document Title, by Document Author, Page x<span class="tag">&lt;/hi1&gt;</span>
      <span class="tag">&lt;/div&gt;</span>
      <span class="tag">&lt;div</span> <span class="attribute-name">class</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">facsimile-navigation</span><span class="delimiter">&quot;</span></span><span class="tag">&gt;</span>
         <span class="comment">&lt;!-- Buttons to go to previous and next page, and back to text --&gt;</span>
      <span class="tag">&lt;/div&gt;</span>
      <span class="tag">&lt;div</span> <span class="attribute-name">class</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">facsimile-page</span><span class="delimiter">&quot;</span></span><span class="tag">&gt;</span>
         <span class="tag">&lt;img</span> <span class="attribute-name">src</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">\images\pages\p123.gif</span><span class="delimiter">&quot;</span></span><span class="tag">/&gt;</span>
      <span class="tag">&lt;/div&gt;</span>
    <span class="tag">&lt;/body&gt;</span>
  <span class="tag">&lt;/html&gt;</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>For each <code>pb</code>-element for which a <code>@facs</code> attribute is present, a link will be generated to the wrapper file, decorated with a facsimile page-image icon.</p>
</div>
</div>
<div class="sect4">
<h5 id="_things_to_show">Things to show</h5>
<div class="paragraph">
<p>In header</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Title of document</p>
</li>
<li>
<p>Name of author</p>
</li>
<li>
<p>Page number (if encoded in <code>@n</code> attribute)</p>
</li>
<li>
<p>Title(s) of current division at bottom of page.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Titles are indicated as follows as bread-crumbs:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>(Front | Body | Back |) &gt; Title Level 1 &gt; Title Level 2 &gt; ... &gt; Page 123</pre>
</div>
</div>
<div class="paragraph">
<p>Each of these elements are active links, and will link back to those pages (content or facsimile view, to be decided)</p>
</div>
<div class="paragraph">
<p>Issue: current code removes unused anchors in HTML post-XSLT-transform, using a Perl script, that needs to be modified, as anchors used by those 'external' HTML files are not recognized.</p>
</div>
<div class="paragraph">
<p>Issue: our current conventions put the <code>pb</code> just before the <code>div#`s. This will lead to the wrong header above the page-image for the first page of a section. Need to add check for case that `pb</code> element is (almost) last element of a <code>div#</code>.</p>
</div>
<div class="paragraph">
<p>In Navigation</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Link to Previous Page. <code>[DONE]</code></p>
</li>
<li>
<p>Link to Next Page. <code>[DONE]</code></p>
</li>
<li>
<p>(Optional) Links to all pages. <code>[TODO]</code></p>
</li>
<li>
<p>Link back to location in transcribed text. <code>[DONE]</code></p>
</li>
</ul>
</div>
</div>
<div class="sect4">
<h5 id="_epub">ePub</h5>
<div class="paragraph">
<p>Similar to HTML, taking into account additions to Spine, metadata, etc.</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Add generated wrapper files to spine <code>[TODO]</code></p>
</li>
<li>
<p>Add page-images to spine <code>[TODO]</code></p>
</li>
</ul>
</div>
<div class="paragraph">
<p>If no text element is present, the page-images should become the primary structure of the text.</p>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_epub3_support">ePub3 Support</h3>
<div class="paragraph">
<p>The ePub 3 standard is a broad overhaul of ePub, and adds a lot of important features to ePub, including support for HTML5 and CSS3, better support for multilingual documents, etc.</p>
</div>
<div class="ulist">
<ul>
<li>
<p>The standard is here: <a href="http://idpf.org/epub/30">ePub 3.0</a>.</p>
</li>
<li>
<p>More details on the <a href="http://code.google.com/p/epub-revision/">epub-revision project page</a>.</p>
</li>
<li>
<p>An extensive <a href="http://sigildev.blogspot.com/">blog post here</a>.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>To be able to use the new features introduced in ePub 3.0, we will need to make a number of changes to <code>tei2html</code>. The driving forces for this effort from the <code>tei2html</code> perspective are:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Better support for HTML5 and CSS3</p>
</li>
<li>
<p>Better support for metadata (including reliable way to specify cover images, etc.)</p>
</li>
<li>
<p>Better way to specify a table of contents.</p>
</li>
<li>
<p>Better ability to embed fonts</p>
</li>
<li>
<p>SVG and MathML support.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>All such new features of course need support from readers. Such support can be expected quickly on PC-based viewers, but may take considerable time to trickle down to dedicated reader hardware.</p>
</div>
<div class="paragraph">
<p>For proper development, we also need to be able to test the resulting ePub3 with a number of supporting readers, which are not available at the time.</p>
</div>
<div class="paragraph">
<p>Features not within current scope are JavaScript support (we like to keep our books passive) and media overlays.</p>
</div>
<div class="sect3">
<h4 id="_things_to_do">Things to do</h4>
<div class="paragraph">
<p>For <code>tei2html</code> to support ePub 3.0 we need to do add some new information to our ePub files. In most cases, that information can easily be derived from the existing TEI files, so no changes to data-files will be required.</p>
</div>
<div class="paragraph">
<p>Also see <a href="http://idpf.org/epub/30/spec/epub30-changes.html">ePub3 changes</a>.</p>
</div>
<div class="paragraph">
<p>Many of the things to-do can be aligned with over-all support for HTML5/CSS3. Specific for ePub3 are:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>NCX replaced by <a href="http://idpf.org/epub/30/spec/epub30-contentdocs.html#sec-xhtml-nav">EPUB Navigation Documents</a>.</p>
</li>
<li>
<p>Page-lists now part of standard.</p>
</li>
<li>
<p>Page <a href="http://idpf.org/epub/30/spec/epub30-contentdocs.html#sec-css-oeb-head-foot">headers and footers</a></p>
</li>
<li>
<p>Improved meta-data in <code>.opf</code> file.</p>
<div class="ulist">
<ul>
<li>
<p>See <a href="http://idpf.org/epub/30/spec/epub30-publications.html#sec-package-metadata-dcmi-transition">Metadata transition</a>.</p>
</li>
</ul>
</div>
</li>
</ul>
</div>
</div>
<div class="sect3">
<h4 id="_changes_to_the_opf_file">Changes to the .OPF file</h4>
<div class="sect4">
<h5 id="_metadata">Metadata</h5>
<div class="paragraph">
<p>New metadata uses the <code>&lt;meta&gt;</code> tag (samples taken from draft ePub 3.0 specification).</p>
</div>
<div class="paragraph">
<p><code>&lt;meta&gt;</code> elements with the <code>@about</code> attribute give further information on the metadata.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="xml"><span class="tag">&lt;metadata&gt;</span>
    <span class="tag">&lt;meta</span> <span class="attribute-name">property</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">dcterms:identifier</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">id</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">dcterms-id</span><span class="delimiter">&quot;</span></span><span class="tag">&gt;</span>urn:uuid:54dc9f06-3174-4b6b-a29a-0dd1fa0969e4<span class="tag">&lt;/meta&gt;</span>
    <span class="tag">&lt;meta</span> <span class="attribute-name">about</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">#pub-id</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">property</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">scheme</span><span class="delimiter">&quot;</span></span><span class="tag">&gt;</span>uuid<span class="tag">&lt;/meta&gt;</span>

    <span class="tag">&lt;meta</span> <span class="attribute-name">property</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">dcterms:identifier</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">id</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">isbn-id</span><span class="delimiter">&quot;</span></span><span class="tag">&gt;</span>urn:isbn:9780101010101<span class="tag">&lt;/meta&gt;</span>
    <span class="tag">&lt;meta</span> <span class="attribute-name">about</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">#isbn-id</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">property</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">scheme</span><span class="delimiter">&quot;</span></span><span class="tag">&gt;</span>isbn<span class="tag">&lt;/meta&gt;</span>

    <span class="tag">&lt;meta</span> <span class="attribute-name">property</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">source-identifier</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">id</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">src-id</span><span class="delimiter">&quot;</span></span><span class="tag">&gt;</span>urn:isbn:9780375704024<span class="tag">&lt;/meta&gt;</span>
    <span class="tag">&lt;meta</span> <span class="attribute-name">about</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">#src-id</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">property</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">scheme</span><span class="delimiter">&quot;</span></span><span class="tag">&gt;</span>isbn<span class="tag">&lt;/meta&gt;</span>

    <span class="tag">&lt;meta</span> <span class="attribute-name">property</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">dcterms:title</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">id</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">title</span><span class="delimiter">&quot;</span></span><span class="tag">&gt;</span>Norwegian Wood<span class="tag">&lt;/meta&gt;</span>
    <span class="tag">&lt;meta</span> <span class="attribute-name">about</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">#title</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">property</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">alternate-script</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">xml:lang</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">ja</span><span class="delimiter">&quot;</span></span><span class="tag">&gt;</span>ãƒŽãƒ«ã‚¦ã‚§ã‚¤ã®æ£®<span class="tag">&lt;/meta&gt;</span>
    <span class="tag">&lt;meta</span> <span class="attribute-name">about</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">#title</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">property</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">title-type</span><span class="delimiter">&quot;</span></span><span class="tag">&gt;</span>primary<span class="tag">&lt;/meta&gt;</span>

    <span class="tag">&lt;meta</span> <span class="attribute-name">property</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">dcterms:modified</span><span class="delimiter">&quot;</span></span><span class="tag">&gt;</span>2011-01-01T12:00:00Z<span class="tag">&lt;/meta&gt;</span>
    <span class="tag">&lt;meta</span> <span class="attribute-name">property</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">dcterms:language</span><span class="delimiter">&quot;</span></span><span class="tag">&gt;</span>en<span class="tag">&lt;/meta&gt;</span>
    <span class="tag">&lt;meta</span> <span class="attribute-name">property</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">page-progression-direction</span><span class="delimiter">&quot;</span></span><span class="tag">&gt;</span>ltr<span class="tag">&lt;/meta&gt;</span>

    <span class="tag">&lt;meta</span> <span class="attribute-name">property</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">dcterms:creator</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">id</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">creator</span><span class="delimiter">&quot;</span></span><span class="tag">&gt;</span>Haruki Murakami<span class="tag">&lt;/meta&gt;</span>
    <span class="tag">&lt;meta</span> <span class="attribute-name">about</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">#creator</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">property</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">alternate-script</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">xml:lang</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">ja</span><span class="delimiter">&quot;</span></span><span class="tag">&gt;</span>æ‘ä¸Š æ˜¥æ¨¹<span class="tag">&lt;/meta&gt;</span>
    <span class="tag">&lt;meta</span> <span class="attribute-name">about</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">#creator</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">property</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">file-as</span><span class="delimiter">&quot;</span></span><span class="tag">&gt;</span>Murakami, Haruki<span class="tag">&lt;/meta&gt;</span>
    <span class="tag">&lt;meta</span> <span class="attribute-name">about</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">#creator</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">property</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">role</span><span class="delimiter">&quot;</span></span><span class="tag">&gt;</span>aut<span class="tag">&lt;/meta&gt;</span>
<span class="tag">&lt;/metadata&gt;</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>Old-fashioned metadata can be linked to their 3.0 equivalents using the <code>@prefer</code> attribute. (I think it is unlikely readers will actually use this; library management software might do so.)</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="xml"><span class="tag">&lt;metadata</span> <span class="attribute-name">xmlns:dc</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">http://purl.org/dc/elements/1.1/</span><span class="delimiter">&quot;</span></span><span class="tag">&gt;</span>
    <span class="tag">&lt;dc:identifier</span> <span class="attribute-name">id</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">pub-id</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">prefer</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">uuid</span><span class="delimiter">&quot;</span></span><span class="tag">&gt;</span>urn:uuid:54dc9f06-3174-4b6b-a29a-0dd1fa0969e4<span class="tag">&lt;/dc:identifier&gt;</span>
    <span class="tag">&lt;meta</span> <span class="attribute-name">property</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">dcterms:identifier</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">id</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">uuid</span><span class="delimiter">&quot;</span></span><span class="tag">&gt;</span>urn:uuid:54dc9f06-3174-4b6b-a29a-0dd1fa0969e4<span class="tag">&lt;/meta&gt;</span>
<span class="tag">&lt;/metadata&gt;</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>Note that the identifier indicated by the <code>@unique-identifier</code> attribute on the <code>&lt;package&gt;</code> element combined with the last modification date is used to generate a package id.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="xml"><span class="tag">&lt;metadata</span> <span class="attribute-name">xmlns:dc</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">http://purl.org/dc/elements/1.1/</span><span class="delimiter">&quot;</span></span><span class="tag">&gt;</span>
    <span class="tag">&lt;dc:identifier</span> <span class="attribute-name">id</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">pub-id</span><span class="delimiter">&quot;</span></span><span class="tag">&gt;</span>urn:uuid:A1B0D67E-2E81-4DF5-9E67-A64CBE366809<span class="tag">&lt;/dc:identifier&gt;</span>

    <span class="tag">&lt;meta</span> <span class="attribute-name">property</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">dcterms:identifier</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">id</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">dcterms-id</span><span class="delimiter">&quot;</span></span><span class="tag">&gt;</span>urn:uuid:A1B0D67E-2E81-4DF5-9E67-A64CBE366809<span class="tag">&lt;/meta&gt;</span>
    <span class="tag">&lt;meta</span> <span class="attribute-name">about</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">#pub-id</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">property</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">scheme</span><span class="delimiter">&quot;</span></span><span class="tag">&gt;</span>uuid<span class="tag">&lt;/meta&gt;</span>

    <span class="tag">&lt;meta</span> <span class="attribute-name">property</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">dcterms:modified</span><span class="delimiter">&quot;</span></span><span class="tag">&gt;</span>2011-01-01T12:00:00Z<span class="tag">&lt;/meta&gt;</span>
<span class="tag">&lt;/metadata&gt;</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>Results in a Package ID: <code>urn:uuid:A1B0D67E-2E81-4DF5-9E67-A64CBE366809@2011-01-01T12:00:00Z</code>.</p>
</div>
</div>
<div class="sect4">
<h5 id="_manifest">Manifest</h5>
<div class="paragraph">
<p>The manifest now has <a href="http://idpf.org/epub/30/spec/epub30-publications.html#sec-item-property-values">manifest item properties</a>, to specify specific roles of the items listed. This can be used to indicate what is the navigation document, and cover-images. This is also required if certain features are used in an element (e.g., mathml, scripted, remove-content, SVG).</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="xml"><span class="tag">&lt;item</span> <span class="attribute-name">properties</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">nav</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">id</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">toc</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">href</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">contents.xhtml</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">media-type</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">application/xhtml+xml</span><span class="delimiter">&quot;</span></span><span class="tag">/&gt;</span>
...
<span class="tag">&lt;item</span> <span class="attribute-name">properties</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">cover-image</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">id</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">cover</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">href</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">cover.svg</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">media-type</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">image/svg+xml</span><span class="delimiter">&quot;</span></span><span class="tag">/&gt;</span></code></pre>
</div>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_navigation_document">Navigation Document</h4>
<div class="paragraph">
<p>The navigation document is now a valid <code>XHTML</code> page, wrapped in the <code>&lt;nav&gt;</code> element.</p>
</div>
</div>
<div class="sect3">
<h4 id="_validation">Validation</h4>
<div class="paragraph">
<p>See this <a href="https://web.archive.org/web/20111221091114/blog.threepress.org/2011/06/13/validating-epub-3-today/">short article originally from threepress</a>.</p>
</div>
</div>
<div class="sect3">
<h4 id="_xhtml">XHTML</h4>
<div class="paragraph">
<p>Will need to generate valid XHTML, which means:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Removal of some attributes, such as summary, valign, align, width, etc. from elements.</p>
</li>
</ul>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_media_overlays_in_epub3">Media-Overlays in ePub3</h3>
<div class="paragraph">
<p>Based on a little reverse engineering of a working book (with the freely available Azardi ePub reader; also tested output with Tobi, which correctly picks-up the files, and the Readium app for Chrome. Other readers remain to be tested).</p>
</div>
<div class="sect3">
<h4 id="_references">References</h4>
<div class="ulist">
<ul>
<li>
<p><a href="https://en.wikipedia.org/wiki/Synchronized_Multimedia_Integration_Language" class="bare">https://en.wikipedia.org/wiki/Synchronized_Multimedia_Integration_Language</a></p>
</li>
<li>
<p><a href="http://data.daisy.org/publications/guidelines/accessible_epub_3_in_epub_3.epub" class="bare">http://data.daisy.org/publications/guidelines/accessible_epub_3_in_epub_3.epub</a></p>
</li>
<li>
<p><a href="http://idpf.org/epub/30/spec/epub30-mediaoverlays.html" class="bare">http://idpf.org/epub/30/spec/epub30-mediaoverlays.html</a></p>
</li>
<li>
<p><a href="https://epub-revision.googlecode.com/svn-history/r1915/trunk/build/EPUB_MediaOverlays30.html#d16293e836" class="bare">https://epub-revision.googlecode.com/svn-history/r1915/trunk/build/EPUB_MediaOverlays30.html#d16293e836</a></p>
</li>
<li>
<p><a href="http://www.daisy.org/project/tobi" class="bare">http://www.daisy.org/project/tobi</a></p>
</li>
<li>
<p><a href="http://azardi.infogridpacific.com/resources.html" class="bare">http://azardi.infogridpacific.com/resources.html</a></p>
</li>
<li>
<p><a href="http://www.tei-c.org/release/doc/tei-p5-doc/en/html/SA.html#SASYMP" class="bare">http://www.tei-c.org/release/doc/tei-p5-doc/en/html/SA.html#SASYMP</a></p>
</li>
<li>
<p><a href="https://forum.librivox.org/viewtopic.php?p=23815#p23815" class="bare">https://forum.librivox.org/viewtopic.php?p=23815#p23815</a></p>
</li>
</ul>
</div>
</div>
<div class="sect3">
<h4 id="_alternative_viewers">Alternative viewers</h4>
<div class="ulist">
<ul>
<li>
<p><a href="http://reader.dinglabs.com/" class="bare">http://reader.dinglabs.com/</a></p>
</li>
<li>
<p><a href="https://www.youtube.com/watch?v=IG00lyK01pQ" class="bare">https://www.youtube.com/watch?v=IG00lyK01pQ</a></p>
</li>
</ul>
</div>
</div>
<div class="sect3">
<h4 id="_synchronizing_text">Synchronizing Text</h4>
<div class="ulist">
<ul>
<li>
<p><a href="https://www.youtube.com/watch?v=dQaVXdgKSn0" class="bare">https://www.youtube.com/watch?v=dQaVXdgKSn0</a></p>
</li>
<li>
<p><a href="https://forum.librivox.org/viewtopic.php?p=226242#p226242" class="bare">https://forum.librivox.org/viewtopic.php?p=226242#p226242</a></p>
</li>
<li>
<p><a href="http://www.mycnknow.com/download/TUTORIAL/tutor.htm" class="bare">http://www.mycnknow.com/download/TUTORIAL/tutor.htm</a></p>
</li>
<li>
<p><a href="http://www.ling.upenn.edu/phonetics/p2fa/" class="bare">http://www.ling.upenn.edu/phonetics/p2fa/</a></p>
</li>
</ul>
</div>
</div>
<div class="sect3">
<h4 id="_smil_files">SMIL Files</h4>
<div class="paragraph">
<p>SMIL files have a structure as given below, and must be placed in the same directory as the referenced HTML file.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="xml"><span class="tag">&lt;smil</span>
    <span class="attribute-name">xmlns</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">http://www.w3.org/ns/SMIL</span><span class="delimiter">&quot;</span></span>
    <span class="attribute-name">xmlns:epub</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">http://www.idpf.org/2007/ops</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">version</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">3.0</span><span class="delimiter">&quot;</span></span><span class="tag">&gt;</span>
  <span class="tag">&lt;body&gt;</span>
    <span class="tag">&lt;seq</span> <span class="attribute-name">id</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">sequence_id</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">epub:textref</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">chapter.xhtml</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">epub:type</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">bodymatter chapter</span><span class="delimiter">&quot;</span></span><span class="tag">&gt;</span>
      <span class="tag">&lt;par</span> <span class="attribute-name">id</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">par1</span><span class="delimiter">&quot;</span></span><span class="tag">&gt;</span>
        <span class="tag">&lt;text</span> <span class="attribute-name">src</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">chapter.xhtml#p1</span><span class="delimiter">&quot;</span></span><span class="tag">/&gt;</span>
        <span class="tag">&lt;audio</span> <span class="attribute-name">clipBegin</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">0:00:00</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">clipEnd</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">0:00:02.162</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">src</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">audio/chapter.mp3</span><span class="delimiter">&quot;</span></span><span class="tag">/&gt;</span>
      <span class="tag">&lt;/par&gt;</span>
      <span class="tag">&lt;par</span> <span class="attribute-name">id</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">par2</span><span class="delimiter">&quot;</span></span><span class="tag">&gt;</span>
        <span class="tag">&lt;text</span> <span class="attribute-name">src</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">chapter.xhtml#p2</span><span class="delimiter">&quot;</span></span><span class="tag">/&gt;</span>
        <span class="tag">&lt;audio</span> <span class="attribute-name">clipBegin</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">0:00:02.162</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">clipEnd</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">0:00:05.718</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">src</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">audio/chapter.mp3</span><span class="delimiter">&quot;</span></span><span class="tag">/&gt;</span>
      <span class="tag">&lt;/par&gt;</span>
    <span class="tag">&lt;/seq&gt;</span>
  <span class="tag">&lt;/body&gt;</span>
<span class="tag">&lt;/smil&gt;</span></code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_mp3_or_ogg_files">MP3 or OGG Files</h4>
<div class="paragraph">
<p>The actual audio files are in a subdirectory called <code>audio</code>.</p>
</div>
</div>
<div class="sect3">
<h4 id="_opf_file">OPF File</h4>
<div class="sect4">
<h5 id="_metadata_section">Metadata section</h5>
<div class="paragraph">
<p>Add a number of media overlay metadata items; they reference items in the manifest.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="xml"><span class="tag">&lt;meta</span> <span class="attribute-name">property</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">media:duration</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">refines</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">#ch1</span><span class="delimiter">&quot;</span></span><span class="tag">&gt;</span>5:30:15<span class="tag">&lt;/meta&gt;</span>
<span class="tag">&lt;meta</span> <span class="attribute-name">property</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">media:duration</span><span class="delimiter">&quot;</span></span><span class="tag">&gt;</span>5:30:15<span class="tag">&lt;/meta&gt;</span>
<span class="tag">&lt;meta</span> <span class="attribute-name">property</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">media:narrator</span><span class="delimiter">&quot;</span></span><span class="tag">&gt;</span>Narrator Name<span class="tag">&lt;/meta&gt;</span>
<span class="tag">&lt;meta</span> <span class="attribute-name">property</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">media:active-class</span><span class="delimiter">&quot;</span></span><span class="tag">&gt;</span>-epub-media-overlay-active<span class="tag">&lt;/meta&gt;</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>Except for the narrator, these items are derived from the <code>.smil</code> files related to each section.</p>
</div>
</div>
<div class="sect4">
<h5 id="_manifest_section">Manifest section</h5>
<div class="paragraph">
<p>Add the <code>.smil</code> and audio files added to the ePub container:</p>
</div>
<div class="paragraph">
<p>This also indicates how to handle fall-back media in an alternative format.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="xml"><span class="tag">&lt;item</span> <span class="attribute-name">id</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">ch1</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">href</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">chapter.smil</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">media-type</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">application/smil+xml</span><span class="delimiter">&quot;</span></span><span class="tag">/&gt;</span>

<span class="tag">&lt;item</span> <span class="attribute-name">id</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">audio01</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">href</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">audio/chapter.mp3</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">fallback</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">audio02</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">media-type</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">audio/mpeg</span><span class="delimiter">&quot;</span></span><span class="tag">/&gt;</span>
<span class="tag">&lt;item</span> <span class="attribute-name">id</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">audio02</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">href</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">audio/chapter.ogg</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">media-type</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">audio/ogg</span><span class="delimiter">&quot;</span></span><span class="tag">/&gt;</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>Then also refer to the media-overlay in the entry for the original (text) items</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="xml"><span class="tag">&lt;item</span> <span class="attribute-name">id</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">chapter</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">href</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">chapter.xhtml</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">media-type</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">application/xhtml+xml</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">media-overlay</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">ch1</span><span class="delimiter">&quot;</span></span><span class="tag">/&gt;</span></code></pre>
</div>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_implementation_in_tei2html">Implementation in <code>tei2html</code></h4>
<div class="paragraph">
<p>Currently, there is no support for SMIL types of overlay in TEI. We can solve this most conveniently by adding a <code>rend</code> attribute to a division, indicating the <code>.smil</code> file to use as an overlay.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="xml"><span class="tag">&lt;div1</span> <span class="attribute-name">id</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">ch1</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">rend</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">media-overlay(chapter1.smil)</span><span class="delimiter">&quot;</span></span><span class="tag">&gt;</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>And then parse the <code>.smil</code> file for the entries that need to be added to the OPF manifest (that is, the <code>.smil</code> file itself and the associated audio files). This leaves us with a way to obtain the required overlay metadata.</p>
</div>
<div class="paragraph">
<p>All this is handled in the file <code>tei2opf.xml</code>.</p>
</div>
</div>
<div class="sect3">
<h4 id="_todo">TODO</h4>
<div class="ulist">
<ul>
<li>
<p>Copy <code>.smil</code> files to ePub output directory. DONE</p>
</li>
<li>
<p>Better handling of media metadata. (Generate them from the smil file). DONE; need to look at minor rounding issues in calculation.</p>
</li>
</ul>
</div>
</div>
<div class="sect3">
<h4 id="_implementation_observations">Implementation observations</h4>
<div class="ulist">
<ul>
<li>
<p>Azardi doesn&#8217;t seem to like ids with periods in them.</p>
</li>
<li>
<p>Azardi needs fallback media to Ogg.</p>
</li>
<li>
<p>Azardi requires a body element of the <code>.smil</code> to have a seq element, the standard also allows par elements directly in the body (as Tobi generates it).</p>
</li>
<li>
<p>Casing of file names is important.</p>
</li>
<li>
<p>Now works fine in Readium, which seems to have a better interface than Azardi.</p>
</li>
</ul>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_coding_conventions">Coding Conventions</h3>
<div class="sect3">
<h4 id="_xslt_domain">XSLT Domain</h4>
<div class="paragraph">
<p>In the XSLT domain, the main naming convention uses dashes, so we use dashes for names of templates, modes, etc., except where such names directly reflect elements from the TEI domain that use <em>camelCase</em>.</p>
</div>
</div>
<div class="sect3">
<h4 id="_tei_domain">TEI Domain</h4>
<div class="paragraph">
<p>In the TEI domain, the main naming convention is <em>camelCase</em>, so for names primarily used in a TEI context, we follow that.</p>
</div>
<div class="sect4">
<h5 id="_use_of_the_type_attribute">Use of the <code>@type</code> attribute</h5>
<div class="paragraph">
<p>The <code>@type</code> attribute can indicate a subclass or special use of a certain element.</p>
</div>
</div>
<div class="sect4">
<h5 id="_special_values">Special values</h5>
<div class="paragraph">
<p>The following table gives special values for the <code>@type</code> attribute in various contexts. These are
handled in a special way when processing the TEI file.</p>
</div>
<div class="paragraph">
<p><strong>TODO</strong> use lower camel case convention for these names.</p>
</div>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 33.3333%;">
<col style="width: 33.3333%;">
<col style="width: 33.3334%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top"><strong>TEI element</strong></th>
<th class="tableblock halign-left valign-top"><strong><code>@type</code> value</strong></th>
<th class="tableblock halign-left valign-top"><strong>Notes</strong></th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>ab</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>divNum</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Indicates a division number (typically within a <code>head</code> element).</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>ab</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>figNum</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Indicates a figure number (typically within a <code>head</code> element).</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>ab</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>flushright</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Indicates the <code>ab</code> should be set flush right. (Deprecated: prefer semantic mark-up)</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>ab</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>itemNum</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Indicates an item number (typically within a <code>item</code> element).</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>ab</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>lineNum</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Indicates a line number (typically within a <code>p</code> or <code>l</code> element).</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>ab</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>lineNumRef</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Indicates a reference to a line number.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>ab</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>parNum</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Indicates a paragraph number.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>ab</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>tocDivNum</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Indicates a division number within a toc.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>ab</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>tocFigNum</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Indicates a figure number within a list of illustrations.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>ab</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>tocPageNum</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Indicates a page number within a toc.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>div1</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>TranscriberNote</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The division is a note by the transcriber (rendered in a different color).</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>div2</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>SubToc</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The division is a toc for the div1 it appears in (content will be replaced by generated content).</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>divGen</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>apparatus</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Generate a section with apparatus notes (can be used multiple times, all apparatus notes between this and the previous instance will be included).</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>divGen</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>Colophon</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Generate a colophon (based on information in the TEI header).</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>divGen</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>ColophonBody</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Generate the body of a colophon (based on information in the TEI header).</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>divGen</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>Footnotes</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Generate a section with footnotes.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>divGen</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>FootnotesBody</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Just the body.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>divGen</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>gallery</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Generate a gallery of illustrations (requires availability of thumbnail images).</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>divGen</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>Inclusion</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Include an external file here; using <code>@url</code> attribute.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>divGen</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>index</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Generate an index.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>divGen</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>IndexToc</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Generate a one-line toc for an Index (displaying single-letter links).</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>divGen</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>LanguageFragments</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Generate a list of fragments in foreign languages (i.e., not the main language of the text).</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>divGen</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>loi</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Generate a list of illustrations.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>divGen</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>pgfooter</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Generate the Project Gutenberg boilerplate footer.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>divGen</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>pgheader</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Generate the Project Gutenberg header.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>divGen</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>toc</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Generate a table of contents. Additional <code>@rend</code> attribute value tocMaxLevel(n) can be used to control the depth.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>divGen</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>toca</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Generate a table of contents (including chapter arguments).</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>divGen</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>tocBody</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Just the body.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>head</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>label</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The (division) heading is a label indicating its type and number. (Typically, 'Chapter IX') Omit when the label is the only head of a chapter.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>head</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>sub</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The (division) heading is a subtitle.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>head</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>super</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The (division) heading is the title of a higher level division. (Typically, the title of the book repeated above the first chapter.)</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>idno</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>epub-id</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The <code>idno</code> gives a unique identifier for the generated ePub file.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>idno</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>ISBN</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The <code>idno</code> gives the ISBN for the edition (don&#8217;t use for the ISBN of the source!).</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>idno</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>LCCN</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The <code>idno</code> gives the Library of Congress call number.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>idno</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>LibThing</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The <code>idno</code> gives the Library Thing catalog number for the edition.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>idno</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>OCLC</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The <code>idno</code> gives the WorldCat catalog number for the edition.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>idno</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>OLN</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The <code>idno</code> gives the Open Library catalog number for the (source) edition.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>idno</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>OLW</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The <code>idno</code> gives the Open Library catalog number for the work.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>idno</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>PGnum</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The <code>idno</code> gives the Project Gutenberg ebook number.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>list</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>determinationTable</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Convert the list to a (potentially nested) table as used for determination in biological works.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>list</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>tocList</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Convert the list to a (potentially nested) table of contents.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>p</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>figBottom</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The paragraph will be placed on the bottom-center of a figure.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>p</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>figBottomLeft</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The paragraph will be placed on the bottom-left of a figure.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>p</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>figBottomRight</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The paragraph will be placed on the bottom-right of a figure.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>p</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>figTop</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The paragraph will be placed on the top-center of a figure.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>p</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>figTopLeft</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The paragraph will be placed on the top-left of a figure.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>p</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>figTopRight</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The paragraph will be placed on the top-right of a figure.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>ref</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>endnoteref</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The reference refers to an end-note.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>ref</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>noteref</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The reference refers to a footnote (The generated footnote number of the note referred to is used in the output; this is intended to be used when a note reference marker is used multiple times to refer to the same footnote, not when referring to a footnote otherwise).</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>ref</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>pageref</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The reference refers to a page (by number; the ref is supposed to only include the actual number referred to).</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>title</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>pgshort</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The title is a short title for Project Gutenberg purposes.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>titlePart</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>main</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The title part is the main title.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>titlePart</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>series</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The title part is a series title.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>titlePart</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>sub</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The title part is a subtitle.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>titlePart</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>volume</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The title part is a volume label (e.g., 'Volume II').</p></td>
</tr>
</tbody>
</table>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 33.3333%;">
<col style="width: 33.3333%;">
<col style="width: 33.3334%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top"><strong>TEI element</strong></th>
<th class="tableblock halign-left valign-top"><strong><code>@place</code> value</strong></th>
<th class="tableblock halign-left valign-top"><strong>Notes</strong></th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>note</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>apparatus</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The note is part of a critical apparatus.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>note</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>foot</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The note is a footnote (<strong>default</strong>).</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>note</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>margin</code>, <code>left</code>, <code>right</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The note is a marginal note (set to the left or right of the text block).</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>note</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>cut-in-left</code>, <code>cut-in-right</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The note is a <em>cut-in</em> note (set inside the text block; the main text flows around it).</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>note</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>table</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The note appears directly under the table it appears in.</p></td>
</tr>
</tbody>
</table>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 33.3333%;">
<col style="width: 33.3333%;">
<col style="width: 33.3334%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top"><strong>TEI element</strong></th>
<th class="tableblock halign-left valign-top"><strong><code>@unit</code> value</strong></th>
<th class="tableblock halign-left valign-top"><strong>Notes</strong></th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>milestone</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>tb</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The milestone is a thematic break.</p></td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_tools">Tools</h2>
<div class="sectionbody">
<div class="sect2">
<h3 id="_auxiliary_tools">Auxiliary Tools</h3>
<div class="paragraph">
<p>Besides the main XSLT scripts, <code>tei2html</code> includes Perl scripts for various tasks. Many of these are quick hacks to get things done.</p>
</div>
<div class="sect3">
<h4 id="_tei2html_pl">tei2html.pl</h4>
<div class="paragraph">
<p>The main 'glue' script. This will run the various commands to actually run the <code>tei2html</code> XSLT scripts.</p>
</div>
<div class="paragraph">
<p>Syntax: <code>perl.pl -S tei2html.pl [options] filename</code></p>
</div>
<div class="paragraph">
<p>For an overview of options, run <code>perl.pl -S tei2html.pl --help</code></p>
</div>
</div>
<div class="sect3">
<h4 id="_ucwords_pl">ucwords.pl</h4>
<div class="paragraph">
<p>Perl script to list word-frequencies in an XML file. This script will recognize the <code>@lang</code> tag, and write a word-frequency list per language encountered. Words in the output will be color-coded, based on frequency and appearance in a spell-check dictionary.</p>
</div>
<div class="paragraph">
<p>Syntax: <code>perl -S ucwords.pl filename</code></p>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_tools_to_generate_plain_text_files">Tools to generate plain text files</h3>
<div class="sect3">
<h4 id="_extractnotes_pl">extractNotes.pl</h4>
<div class="paragraph">
<p>Extract TEI tagged notes from a text file.</p>
</div>
<div class="paragraph">
<p>Usage:</p>
</div>
<div class="literalblock">
<div class="content">
<pre>perl extractNotes.pl [-h] &lt;filename&gt;</pre>
</div>
</div>
<div class="paragraph">
<p>Options:</p>
</div>
<div class="literalblock">
<div class="content">
<pre>-h	perpare for HTML output.</pre>
</div>
</div>
<div class="paragraph">
<p>This produces two output files:</p>
</div>
<div class="literalblock">
<div class="content">
<pre>&lt;filename&gt;.out	The original text without the notes
&lt;filename&gt;.not	The notes</pre>
</div>
</div>
<div class="paragraph">
<p>If the <code>-h</code> option is used, hyperlinks between the two files are inserted.
Otherwise, the notes are indicated with a sequence number in square
brackets.</p>
</div>
</div>
<div class="sect3">
<h4 id="_tei2txt_pl">tei2txt.pl</h4>
<div class="paragraph">
<p>Convert a TEI file to plain vanilla ASCII.</p>
</div>
<div class="paragraph">
<p>Usage:</p>
</div>
<div class="literalblock">
<div class="content">
<pre>perl tei2txt.pl &lt;filename&gt;</pre>
</div>
</div>
<div class="paragraph">
<p>Notes:</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>This script assumes <code>extractNotes.pl</code> has been run before.</p>
</li>
<li>
<p>Accented and special letters are converted to their nearest ASCII equivalents.</p>
</li>
</ol>
</div>
</div>
<div class="sect3">
<h4 id="_tei2txt_bat">tei2txt.bat</h4>
<div class="paragraph">
<p>Convert a TEI file to plain vanilla ASCII.</p>
</div>
<div class="paragraph">
<p>This batch files runs extractNotes.pl, concatenates the two resulting files, and then runs tei2txt.pl on the resulting file. The result is a single ASCII file.</p>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_tools_for_post_processing_pgdp_output">Tools for post-processing PGDP output</h3>
<div class="sect3">
<h4 id="_fixpb_pl">fixpb.pl</h4>
<div class="paragraph">
<p>Perl script to fix page numbers, as recorded in the <code>@n</code> attribute in <code>&lt;pb&gt;</code> elements. This will also set the <code>@id</code> attribute to <code>pb#</code>, where <code>#</code> is the current page number. Page-numbers will be changed after the page indicated, with an offset indicated. To fix mismatched page-numbers, always start with the first mismatch, and run the script as many times as needed (this typically occurs if the original source had unnumbered pages with illustrations.)</p>
</div>
<div class="paragraph">
<p>For an overview of options, run <code>perl.pl -S fixpb.pl --help</code></p>
</div>
</div>
<div class="sect3">
<h4 id="_catpars_pl">catpars.pl</h4>
<div class="paragraph">
<p>Perl script to unwrap paragraphs, such that they appear on one line. Handle with care, as it might unwrap entire tables or lists if it deems them part of a paragraph.</p>
</div>
</div>
<div class="sect3">
<h4 id="_quotes_pl">quotes.pl</h4>
<div class="paragraph">
<p>Perl script to replace ASCII single and double-quotes with curly quotes. May need some manual verification and correction where quotes and tags interfere with the simple algorithm used.</p>
</div>
<div class="paragraph">
<p>Issues:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Open quotes before SGML tags and non-letters may go wrong (they become the default: a close quote).</p>
</li>
<li>
<p>Manually check for ASCII single-quotes, and apply the correct one. Use <code>tei2html.pl</code> with the <code>-v</code> option to find cases where quotes are still not balanced.</p>
</li>
</ul>
</div>
</div>
<div class="sect3">
<h4 id="_pgpp_pl">pgpp.pl</h4>
<div class="paragraph">
<p>Script run initially on the output from PG Distributed Proofreaders, when converting that to TEI (The actual conversion is a manual process, as the resulting output is still very far removed from being an actual TEI file).</p>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_tools_for_preparing_texts_for_pgdp">Tools for preparing texts for PGDP</h3>
<div class="sect3">
<h4 id="_pgprepare_pl">pgprepare.pl</h4>
<div class="paragraph">
<p>Script run to convert a bunch of text files to UTF-8, normalize spacing, and remove unwanted characters.</p>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_merging_texts">Merging Texts</h3>
<div class="paragraph">
<p>Larger works were often issued in multi-volume sets, and as a result often also encoded as separate TEI files. However, in files do not have the restrictions of physical bound volumes, and it is often beneficial to merge two or more TEI files into a single TEI file. This will help in particular when there are a lot of internal cross-references between the volumes, such as will happen with an index (which often appears in the last volume).</p>
</div>
<div class="sect3">
<h4 id="_steps">Steps</h4>
<div class="sect4">
<h5 id="_1_create_an_xslt_galley_file">1. Create an XSLT 'galley' file</h5>
<div class="paragraph">
<p>The idea is to create an XSLT stylesheet that will merge the individual volumes, and provide them with a new TEI-header (which in turn can also be put together from elements pulled from the TEI-header of one or more of the source TEI files. Some things to consider:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Combined TEI-header. Often using the contents of the first TEI-header, with some minor changes will be enough.</p>
</li>
<li>
<p>Combined tables-of-contents. Here, we may need to have some smart xpath queries to extract the various fragments of the table-of-contents from the various volumes (or simply generate the entire thing anew).</p>
</li>
<li>
<p>Combined body content, which may require the introduction of a new level of divisions ("parts" or "volumes"), which in turn may require adjusting the levels of numbered <code>div</code> elements (e.g. <code>div1</code> may need to become <code>div2</code>, etc.).</p>
</li>
<li>
<p>Combined material in the front- or back-matter (such as Appendices), which may require some re-numbering.</p>
</li>
</ul>
</div>
</div>
<div class="sect4">
<h5 id="_2_run_the_xslt_galley_file">2. Run the XSLT galley file</h5>
<div class="paragraph">
<p>Here we run XSLT over the galley file to create a new TEI file. In this step we will collect the content, and put it together to form a new single TEI file.</p>
</div>
</div>
<div class="sect4">
<h5 id="_3_use_the_combined_file_as_source">3. Use the combined file as source</h5>
<div class="paragraph">
<p>Here we run XSLT again to perform the conversion to the final output format, on the output of step 2 above.</p>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_galley_file_support_functions">Galley File Support Functions</h4>
<div class="paragraph">
<p>Most of the hard work happens in the creation of the galley file. For this a number of support functions are needed.</p>
</div>
<div class="paragraph">
<p><em>Change Ids</em> To prevent id-clashes, the ids in both source TEI files need to be changed. This is done best by prefixing them with a unique string for each volume.</p>
</div>
<div class="paragraph">
<p>However, not all ids should be treated as such, as that would break inter-volume cross-references. To prevent this, such inter-volume cross-references should already have the prefix when they are referred to in other volumes, and the software should be smart enough not to add the prefix once more.</p>
</div>
<div class="paragraph">
<p>Furthermore, a number of ids have special value to the rendering process, and should be kept verbatim as well. The ids should be preserved (at most once) as-is in one of the source volumes.</p>
</div>
<div class="paragraph">
<p>Finally, some elements might no longer be needed in the combined volume (such as textual references to another volume, or labels giving the volume number.) They should be filtered out.</p>
</div>
<div class="paragraph">
<p>To make this easy, we will need to supplement the standard XSLT import function with a smart import that will take care of those changes. See the function <code>f:import-document</code> in <code>merge-documents.xsl</code> for the implementation.</p>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_checking_a_tei_file">Checking a TEI file</h3>
<div class="paragraph">
<p>XSLT style-sheet to check various TEI conventions and textual issues.</p>
</div>
<div class="sect3">
<h4 id="_metadata_2">Metadata</h4>
<div class="paragraph">
<p>Verify metadata is present and correct.</p>
</div>
</div>
<div class="sect3">
<h4 id="_rendering">Rendering</h4>
<div class="paragraph">
<p>Verify valid rendering attributes are used</p>
</div>
<div class="ulist">
<ul>
<li>
<p>valid CSS-based rendition ladders</p>
</li>
<li>
<p>valid tei2html extensions.</p>
</li>
</ul>
</div>
</div>
<div class="sect3">
<h4 id="_types">Types</h4>
<div class="paragraph">
<p>Verify types for elements are valid according to the conventions.</p>
</div>
</div>
<div class="sect3">
<h4 id="_numbering">Numbering</h4>
<div class="paragraph">
<p>Verify whether numbered items are in sequence.</p>
</div>
<div class="ulist">
<ul>
<li>
<p>page-breaks <code>&lt;pb&gt;</code></p>
</li>
<li>
<p>divisions <code>&lt;div#&gt;</code></p>
</li>
</ul>
</div>
</div>
<div class="sect3">
<h4 id="_spacing_and_punctuation">Spacing and Punctuation</h4>
<div class="paragraph">
<p>Verify punctuation marks are properly spaced.</p>
</div>
</div>
<div class="sect3">
<h4 id="_quotation_marks">Quotation Marks</h4>
<div class="paragraph">
<p>Verify whether quotation marks are applied correctly.</p>
</div>
<div class="paragraph">
<p>Quotation marks need to be nested correctly, and for each
opening mark, there should be a corresponding closing mark.</p>
</div>
<div class="paragraph">
<p>This is slightly complicated by several facts:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>different types of usage</p>
<div class="ulist">
<ul>
<li>
<p>US: outer double, inner single quotation marks</p>
</li>
<li>
<p>UK: outer single, inner double quotation marks</p>
</li>
</ul>
</div>
</li>
<li>
<p>different conventions for languages and countries.</p>
</li>
<li>
<p>usage around other punctuation might vary.</p>
</li>
<li>
<p>non-closed marks are to be re-opened in next paragraph.</p>
</li>
</ul>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_generating_a_kwic_index">Generating a KWIC index</h3>
<div class="paragraph">
<p>For quite some time, I wanted to be able to generate a KWIC (Key Word In Context) index of TEI files. With a KWIC, you can quickly inspect the usage of certain words in a context, which helps to determine how words are used.</p>
</div>
<div class="sect3">
<h4 id="_requirements_2">Requirements</h4>
<div class="paragraph">
<p>The KWIC generator should:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Show all words in their context.</p>
</li>
<li>
<p>Indicate the page on which they appear.</p>
</li>
<li>
<p>Indicate the (tagged) language of the keyword.</p>
</li>
<li>
<p>Be able to show words in italics (and other font-styles).</p>
</li>
<li>
<p>Break up a text into segments to have meaningful contexts.</p>
</li>
<li>
<p>Ignore other tags in the text.</p>
</li>
<li>
<p>Handle text in footnotes correctly.</p>
</li>
<li>
<p>Present the resulting KWIC in HTML.</p>
</li>
<li>
<p>Work with all Unicode supported scripts.</p>
</li>
<li>
<p>Ignore case and accent variants (but they should be preserved and signalled).</p>
</li>
<li>
<p>Ignore differences between common ligatures and loose characters (such as <em>Ã¦</em> and <em>ae</em>)</p>
</li>
<li>
<p>Properly handle a mixture of left-to-right and right-to-left scripts (as Hebrew and Arabic).</p>
</li>
<li>
<p>Optionally ignore differences between look-alike characters or sequences (such as <em>b</em> and <em>h</em>, or <em>rn</em> and <em>m</em>)</p>
</li>
<li>
<p>Optionally only show words of which more than one variant appears after ignoring minor differences.</p>
</li>
</ul>
</div>
</div>
<div class="sect3">
<h4 id="_development">Development</h4>
<div class="paragraph">
<p>For a long time, I have felt that XSLT 2.0 was the right tool for the job. XSLT 1.0 lacked the required regular expression facilities to break text into words effectively, while other programming languages, such as PERL or Python, are much less suited to handling XML textual data.</p>
</div>
<div class="paragraph">
<p>The first idea was that you can easily use <code>xsl:analyze-string</code> to split up fragments of text into words, using a regular expression (the expression is a variant of: <code>[\p{L}\p{N}\p{M}-]+</code> ). Given those words, you can then traverse the text, looking for the word you are interested in, and determine the preceding and following words, by following the <code>preceding-sibling</code> and <code>following-sibling</code> axes.</p>
</div>
<div class="paragraph">
<p>This worked fine, but quickly showed that not all context is equally relevant. Basically, you need not look further than paragraph boundaries and their equivalents in various parts of a documents. So, before splitting in words, we divide the text in segments, and flatten that segment structure. At the same time, we need to take care to lift non-sequential items, such as footnotes out of the context (and handle them elsewhere.)</p>
</div>
<div class="paragraph">
<p>Having done this for one word, it is fairly easy to iterate over all words in the document and build a KWIC for each of them. However, this is a very inefficient way to do it, if we want a KWIC index for all words. So instead, we simply start with the first word, collecting contexts as we go, and then sort them into the desired order afterwards. (Order by word, and then by the following context, or preceding context retrograde.)</p>
</div>
<div class="paragraph">
<p>Generating a KWIC unfortunately consumes a considerable amount of memory, so some tuning is required to be able to handle large texts. KWIC indexes tend to get fairly big: a 2 megabyte text can result in an 80 megabyte KWIC index, especially if no stop-word-list is used to remove the most common words.</p>
</div>
<div class="paragraph">
<p>The result is <code>xml2kwic.xsl</code>, about 500 lines of XSLT code (including documentation comments), that produces a KWIC index from a TEI file in a few seconds. This can be used in two modes. In the first, a KWIC is generated for every word in the document (including such common words as 'the' or 'a'), in the second, a word or list of words is provided to the script, and a KWIC of only those words is build: handy for example to compare the usage of two different spellings or synonyms.</p>
</div>
<div class="paragraph">
<p>The XSLT script currently accepts the following parameters:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>keyword</code>: one or more keywords to generate a KWIC for.</p>
</li>
<li>
<p><code>select-language</code>: one or more (space separated) codes of languages to generate a KWIC for.</p>
</li>
<li>
<p><code>case-sensitive</code>: should casing be folded to lowercase (one of true or false).</p>
</li>
<li>
<p><code>min-variant-count</code>: the minimum number of variants required for a word to be reported upon.</p>
</li>
<li>
<p><code>mixup</code>: a number of (space separated) symbols that need to be treated as equal.</p>
</li>
<li>
<p><code>context-size</code>: the size of the context being shown in the report-out.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Calling the script has been integrated into <code>tei2html.pl</code>.</p>
</div>
<div class="paragraph">
<p>A particularly useful way of generating a kwic is with:</p>
</div>
<div class="paragraph">
<p><code>tei2html -k --kwicvariants=2 --kwiccasesensitive=true</code></p>
</div>
</div>
<div class="sect3">
<h4 id="_having_fun_with_kwic">Having fun with KWIC</h4>
<div class="paragraph">
<p>The KWIC little tool already has helped me to locate numerous small issues Project Gutenberg texts that would otherwise have escaped the attention of proofreaders. In particular variant spellings of names and consistent usage of hyphenated versus non-hyphenated words are often difficult to catch, while in a KWIC, they simply jump into your face.</p>
</div>
<div class="paragraph">
<p>Some issues in texts I&#8217;ve found with this script:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Variant ways of references to cited works.</p>
</li>
<li>
<p>Spelling variants in names. Personal names are normally not known to spelling checkers, and can be spelled in various ways. An added complication is that another person may have a similar name, so you really need the context to make that out.</p>
</li>
<li>
<p>Checking a (preexisting) index. The index entry will show up in the KWIC with the page number it lists, together with the referenced phrase (and page number).</p>
</li>
<li>
<p>Missing periods after common abbreviations.</p>
</li>
<li>
<p>Inconsistent styling. Foreign words that are mostly given in italics, but sometimes not.</p>
</li>
<li>
<p>Hyphenated version non-hyphenated words.</p>
</li>
</ul>
</div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_future_ideas_2">Future Ideas</h2>
<div class="sectionbody">
<div class="sect2">
<h3 id="_css_stylesheet_redesign_todo">CSS stylesheet redesign [TODO]</h3>
<div class="paragraph">
<p>The CSS stylesheets with <code>tei2html</code> have grown over time, and as a result are not very consistent or easy to maintain. To remedy this, I will redesign them using a more structured approach.</p>
</div>
<div class="paragraph">
<p>This will involve the following</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p><code>reset.css</code> â€“ reset all browser dependent settings, to achieve better consistency across browsers.</p>
</li>
<li>
<p>use the BEM philosophy, to make the stylesheets easier to maintain.</p>
</li>
</ol>
</div>
<div class="sect3">
<h4 id="_bem_for_epub">BEM for ePub</h4>
<div class="paragraph">
<p>BEM (Block Element Modifier) was developed to make the maintenance of CSS for websites easier. This does not always translate one-on-one to ebooks, but most of the principles can be applied without much trouble.</p>
</div>
<div class="paragraph">
<p>The main blocks that can easily be identified:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><strong>Cover</strong> (either newly designed or original, or both)</p>
</li>
<li>
<p><strong>Title page</strong> (either newly designed or original, or both)</p>
</li>
<li>
<p><strong>Text</strong> (no distinction made between front matter, main body, and back matter, as they are normally typographically treated the same.)</p>
</li>
<li>
<p><strong>Advertisements</strong> (reproduced advertisements from the original book)</p>
</li>
<li>
<p><strong>Colophon</strong> (our own metadata regarding the book)</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Common elements in books:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Figures and plates</p>
</li>
<li>
<p>Tables of Contents</p>
</li>
<li>
<p>Tables</p>
</li>
<li>
<p>Lists</p>
</li>
<li>
<p>Index</p>
</li>
</ul>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_parsing_css_experimental">Parsing CSS [Experimental]</h3>
<div class="paragraph">
<p>If we could easily parse CSS with XSLT, this would make it far easier to generate optimized HTML. Currently, we include the full CSS stylesheets with even the simplest texts, which increases clutter. If we parse a CSS stylesheet, and only retain those CSS rules that actually apply, text size and clutter is reduced.</p>
</div>
<div class="sect3">
<h4 id="_current_implementation">Current Implementation</h4>
<div class="paragraph">
<p>The current implementation is in <code>css2xml.xsl</code>, which is incomplete. The CSS is parsed in a number of passes. Currently, the code not yet parses all valid CSS 2.1 stylesheets. In particular, <code>@media</code> groups are not supported.</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>tokenize with a simple regular expression based 'lexer'</p>
</li>
<li>
<p>group things between braces using 'sibling recursion' to match open braces with closing braces.</p>
</li>
<li>
<p>group properties, based on semicolons.</p>
</li>
<li>
<p>determine key-value pairs, based on the semicolon.</p>
</li>
<li>
<p>determine selectors.</p>
</li>
<li>
<p>clean-up parsing artifacts.</p>
</li>
</ol>
</div>
<div class="paragraph">
<p>Items remaining to do are:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Better follow tokenization as defined for <a href="http://www.w3.org/TR/CSS21/syndata.html#tokenization">CSS 2.1 tokenization</a>.</p>
</li>
<li>
<p>Properly understand all valid CSS 2.1 features.</p>
</li>
<li>
<p>Implement a way to translate CSS selectors to XPath expressions.</p>
</li>
</ul>
</div>
</div>
<div class="sect3">
<h4 id="_usage">Usage</h4>
<div class="paragraph">
<p>Having CSS in XML, makes it easier to determine from within XSLT what rules within CSS kan be removed or rewritten in a simpler form.</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Determine which CSS rules are actually used in an HTML document.</p>
</li>
<li>
<p>Determine which CSS rules are overruled within the same CSS stylesheet.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>As a result, the CSS stylesheet can be pruned, and only the relevant rules emitted in the output.</p>
</div>
</div>
<div class="sect3">
<h4 id="_references_2">References</h4>
<div class="ulist">
<ul>
<li>
<p>Some great implementation ideas are in <a href="http://www.gerixsoft.com/blog/xslt/json2xml">json2xml</a></p>
</li>
<li>
<p>Need to translate CSS selectors to XPath.</p>
</li>
<li>
<p>Need to keep transformation result in variable to do tests against.</p>
</li>
</ul>
</div>
</div>
</div>
</div>
</div>
</div>
<div id="footer">
<div id="footer-text">
Last updated 2025-03-25 22:01:32 UTC
</div>
</div>
</body>
</html>